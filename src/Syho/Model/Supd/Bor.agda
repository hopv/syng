--------------------------------------------------------------------------------
-- Super update on the bprrpw
--------------------------------------------------------------------------------

{-# OPTIONS --without-K --sized-types #-}

module Syho.Model.Supd.Bor where

open import Base.Level using (Level; _âŠ”á´¸_; 1á´¸)
open import Base.Func using (_$_; _â–·_; _â€º_)
open import Base.Eq using (_â‰¡_; refl)
open import Base.Bool using (ğ”¹; tt; ff)
open import Base.Option using (Â¿_; Å¡_; Åˆ)
open import Base.Prod using (_Ã—_; _,_; -,_; _,-; -á´µ,_; âˆ‘-case)
open import Base.Nat using (â„•)
open import Base.Ratp using (â„šâº; _/2âº; â‰ˆá´¿âº-refl; â‰ˆá´¿âº-sym)
open import Syho.Logic.Prop using (Lft; Propâˆ)
open import Syho.Model.ERA.Bor using (Envá´®áµ’Ê³; Îµá´®áµ’Ê³; boráµ-lend-new; boráµ-open;
  oboráµ-close; lend-back)
open import Syho.Model.ERA.Glob using (já´®áµ’Ê³; âˆ…á´µâ¿á´³)
open import Syho.Model.Prop.Base using (Propáµ’; _âŠ¨âœ“_; _âŠ¨_; âŠ¨_; âŒœ_âŒáµ’Ã—_; _âˆ—áµ’_;
  âˆ—áµ’â‡’âˆ—áµ’'; âˆ—áµ’'â‡’âˆ—áµ’; âˆ—áµ’-Mono; âˆ—áµ’-mono; âˆ—áµ’-monoâœ“Ë¡; âˆ—áµ’-monoË¡; âˆ—áµ’-monoâœ“Ê³; âˆ—áµ’-monoÊ³;
  âˆ—áµ’-comm; âˆ—áµ’-assocË¡; âˆ—áµ’-assocÊ³; ?âˆ—áµ’-comm; âˆ—áµ’-pullÊ³Â²; âˆ—áµ’-pushÊ³Â²Ë¡; ?âˆ—áµ’-intro;
  âˆ—áµ’-elimË¡; âˆ—áµ’-elimÊ³; âˆƒáµ’âˆ—áµ’-out; â–¡áµ’-elim; dup-â–¡áµ’; â¤‡á´±-monoâœ“; â¤‡á´±-mono; â¤‡á´±-param;
  â¤‡á´±-eatÊ³; â†-â—âŸ¨âŸ©-â¤‡á´±; Îµâ†-â—âŸ¨âŸ©-â¤‡á´±)
open import Syho.Model.Prop.Basic using (â¸¨_â¸©á´®; â¸¨â¸©á´®-Mono)
open import Syho.Model.Prop.Smry using (Smry; Smry-0; Smry-add-Å¡; Smry-rem-<;
  Smry-upd)
open import Syho.Model.Prop.Lft using ([_]á´¸âŸ¨_âŸ©áµ’; â€ á´¸áµ’_; []á´¸âŸ¨âŸ©áµ’-resp;
  []á´¸âŸ¨âŸ©áµ’-merge-/2; []á´¸âŸ¨âŸ©áµ’-split-/2; dup-â€ á´¸áµ’; []á´¸âŸ¨âŸ©áµ’-â€ á´¸áµ’-no)
open import Syho.Model.Prop.Bor using (Boráµ; &áµâŸ¨_âŸ©áµ’_; Oboráµ; %áµâŸ¨_âŸ©áµ’_; Lend;
  âŸ¨â€ _âŸ©áµ’_; &áµáµ’-âŸ¨â€ âŸ©áµ’-make)
open import Syho.Model.Prop.Basic using (â¸¨â¸©á´®-Mono)
open import Syho.Model.Prop.Interp using (â¸¨_â¸©; â¸¨â¸©-á´®â‡’; â¸¨â¸©-Mono)
open import Syho.Model.Prop.Sound using (âŠ¢-sem)
open import Syho.Model.Supd.Base using ([_]â‡›áµÂ¹_; â‡›áµ-monoâœ“; â‡›áµ-mono; âŠ¨âœ“â‡’âŠ¨-â‡›áµ;
  â‡›áµÂ¹-make; â‡›áµÂ¹-intro; â‡›áµ-eatË¡)

private variable
  Å‚ :  Level
  i :  â„•
  p :  â„šâº
  pË‡ :  Â¿ â„šâº
  b :  ğ”¹
  Î± :  Lft
  P :  Propâˆ
  Páµ’ :  Propáµ’ Å‚

--------------------------------------------------------------------------------
-- Super update on Borá´±á´¿á´¬

-- Lineá´®áµ’Ê³ :  Line for Invá´®áµ’Ê³

Lineá´®áµ’Ê³ :  Â¿ â„šâº Ã— ğ”¹ Ã— Lft Ã— Propâˆ â†’  Propáµ’ 1á´¸
Lineá´®áµ’Ê³ (-, ff , Î± , _) =  â€ á´¸áµ’ Î±
Lineá´®áµ’Ê³ (Åˆ , tt , -, P) =  â¸¨ P â¸©
Lineá´®áµ’Ê³ (Å¡ p , tt , Î± , _) =  [ Î± ]á´¸âŸ¨ p /2âº âŸ©áµ’

-- Invá´®áµ’Ê³ :  Invariant for Borá´±á´¿á´¬

Invá´®áµ’Ê³ :  Envá´®áµ’Ê³ â†’  Propáµ’ 1á´¸
Invá´®áµ’Ê³ (EË™ , n) =  Smry (Î» _ â†’ Lineá´®áµ’Ê³) EË™ n

-- Super update on Invá´±á´¿á´¬Borá´±á´¿á´¬

infix 3 â‡›á´®áµ’Ê³_
â‡›á´®áµ’Ê³_ :  Propáµ’ Å‚ â†’  Propáµ’ (1á´¸ âŠ”á´¸ Å‚)
â‡›á´®áµ’Ê³ Páµ’ =  [ já´®áµ’Ê³ , Invá´®áµ’Ê³ ]â‡›áµÂ¹ Páµ’

abstract

  -- Get Invá´®áµ’Ê³ (âˆ…á´µâ¿á´³ já´®áµ’Ê³) for free

  Invá´®áµ’Ê³-âˆ… :  âŠ¨ Invá´®áµ’Ê³ (âˆ…á´µâ¿á´³ já´®áµ’Ê³)
  Invá´®áµ’Ê³-âˆ… =  Smry-0

  -- Introduce â‡›á´®áµ’Ê³

  â‡›á´®áµ’Ê³-intro :  Páµ’  âŠ¨ â‡›á´®áµ’Ê³  Páµ’
  â‡›á´®áµ’Ê³-intro =  â‡›áµÂ¹-intro

  -- Get &áµâŸ¨ Î± âŸ©áµ’ P and âŸ¨â€  Î± âŸ©áµ’ P by storing P

  &áµáµ’-new :  â¸¨ P â¸©  âŠ¨ â‡›á´®áµ’Ê³  &áµâŸ¨ Î± âŸ©áµ’ P  âˆ—áµ’  âŸ¨â€  Î± âŸ©áµ’ P
  &áµáµ’-new =  â‡›áµÂ¹-make $ ?âˆ—áµ’-intro (Îµâ†-â—âŸ¨âŸ©-â¤‡á´± boráµ-lend-new) â€º â¤‡á´±-eatÊ³ â€º
    â¤‡á´±-mono (Î» _ â†’ âˆ—áµ’-mono &áµáµ’-âŸ¨â€ âŸ©áµ’-make Smry-add-Å¡) â€º â¤‡á´±-param

  -- Get â¸¨ P â¸© out of Lineá´®áµ’Ê³ with Åˆ using []á´¸âŸ¨âŸ©áµ’

  []á´¸âŸ¨âŸ©áµ’-open :  [ Î± ]á´¸âŸ¨ p âŸ©áµ’  âˆ—áµ’  Lineá´®áµ’Ê³ (Åˆ , b , Î± , P)  âŠ¨âœ“
                   âŒœ b â‰¡ tt âŒáµ’Ã—  [ Î± ]á´¸âŸ¨ p âŸ©áµ’  âˆ—áµ’  â¸¨ P â¸©
  []á´¸âŸ¨âŸ©áµ’-open {b = tt} _ =  refl ,_
  []á´¸âŸ¨âŸ©áµ’-open {b = ff} âœ“âˆ™ =  []á´¸âŸ¨âŸ©áµ’-â€ á´¸áµ’-no âœ“âˆ™ â€º Î» ()

  -- Take â¸¨ P â¸© out using Boráµ and [ Î± ]á´¸âŸ¨ p âŸ©áµ’,
  -- getting [ Î± ]á´¸âŸ¨ p /2âº âŸ©áµ’ and Oboráµ i Î± p P in return

  Boráµ-open :  [ Î± ]á´¸âŸ¨ p âŸ©áµ’  âˆ—áµ’  Boráµ i Î± P  âŠ¨ â‡›á´®áµ’Ê³
                 â¸¨ P â¸©  âˆ—áµ’  [ Î± ]á´¸âŸ¨ p /2âº âŸ©áµ’  âˆ—áµ’  Oboráµ i Î± p P
  Boráµ-open =  â‡›áµÂ¹-make $ âˆ—áµ’-assocÊ³ â€º ?âˆ—áµ’-comm â€º âˆ—áµ’-monoË¡ (â†-â—âŸ¨âŸ©-â¤‡á´± boráµ-open) â€º
    -- Oborâˆ—[Î±]âŸ¨pâŸ©âˆ—Inv â†’ Oborâˆ—[Î±]âŸ¨pâŸ©âˆ—Lineâˆ—Inv â†’ â†’ â†’ Oborâˆ—[Î±]âŸ¨pâŸ©âˆ—Pâˆ—Inv â†’ â†’
    -- Oborâˆ—[Î±]âŸ¨p/2âŸ©âˆ—[Î±]âŸ¨p/2âŸ©âˆ—Pâˆ—Inv â†’ Oborâˆ—[Î±]âŸ¨p/2âŸ©âˆ—Pâˆ—[Î±]âŸ¨p/2âŸ©âˆ—Inv â†’
    -- Oborâˆ—[Î±]âŸ¨p/2âŸ©âˆ—Pâˆ—Inv â†’ â†’ (Oborâˆ—[Î±]âŸ¨p/2âŸ©âˆ—P)âˆ—Inv â†’ â†’ (Pâˆ—[Î±]âŸ¨p/2âŸ©âˆ—Obor)âˆ—Inv
    â¤‡á´±-eatÊ³ â€º â¤‡á´±-monoâœ“ (Î» (i<n , b , Eiâ‰¡) âœ“âˆ™ â†’ âˆ—áµ’-monoâœ“Ê³ (Î» âœ“âˆ™ â†’
      âˆ—áµ’-monoÊ³ (Smry-rem-< i<n Eiâ‰¡) â€º âˆ—áµ’-assocË¡ â€º
      âˆ—áµ’-monoâœ“Ë¡ ([]á´¸âŸ¨âŸ©áµ’-open {b = b}) âœ“âˆ™ â€º âˆƒáµ’âˆ—áµ’-out â€º âˆ‘-case Î»{ refl â†’
      âˆ—áµ’-assocÊ³ â€º âˆ—áµ’-monoË¡ []á´¸âŸ¨âŸ©áµ’-split-/2 â€º âˆ—áµ’-assocÊ³ â€º
      âˆ—áµ’-monoÊ³ (?âˆ—áµ’-comm â€º âˆ—áµ’-monoÊ³ Smry-upd) â€º âˆ—áµ’-assocË¡ }) âœ“âˆ™ â€º
      âˆ—áµ’-assocË¡ â€º âˆ—áµ’-monoË¡ $ ?âˆ—áµ’-comm â€º âˆ—áµ’-pullÊ³Â²) â€º â¤‡á´±-param

  -- Take â¸¨ P â¸© out using &áµ and []á´¸âŸ¨âŸ©áµ’, getting %áµ in return

  &áµáµ’-open :  [ Î± ]á´¸âŸ¨ p âŸ©áµ’  âˆ—áµ’  &áµâŸ¨ Î± âŸ©áµ’ P  âŠ¨ â‡›á´®áµ’Ê³  â¸¨ P â¸©  âˆ—áµ’  %áµâŸ¨ Î± , p âŸ©áµ’ P
  &áµáµ’-open {p = p} =  âˆ—áµ’â‡’âˆ—áµ’' â€º
    Î»{ (-, -, âˆ™âŠ‘ , [Î±]b , -, Q , -á´µ, -, Q|RâŠ¢âŠ£P@(Qâˆ—RâŠ¢P ,-) , â–¡Qâˆ—BorRc) â†’
    let MonoQ = â¸¨â¸©á´®-Mono {Q} in âˆ—áµ’'â‡’âˆ—áµ’ (-, -, âˆ™âŠ‘ , [Î±]b , â–¡Qâˆ—BorRc) â–·
    -- [Î±]âŸ¨pâŸ©âˆ—â–¡Qâˆ—Bor â†’ â–¡Qâˆ—[Î±]âŸ¨pâŸ©âˆ—Bor â†’ â–¡Qâˆ—Râˆ—[Î±]âŸ¨p/2âŸ©âˆ—Obor â†’ â†’
    -- â–¡Qâˆ—â–¡Qâˆ—Râˆ—[Î±]âŸ¨p/2âŸ©âˆ—Obor â†’ â†’ Qâˆ—â–¡Qâˆ—Râˆ—[Î±]âŸ¨p/2âŸ©âˆ—Obor â†’ Qâˆ—Râˆ—â–¡Qâˆ—[Î±]âŸ¨p/2âŸ©âˆ—Obor â†’
    -- (Qâˆ—R)âˆ—â–¡Qâˆ—[Î±]âŸ¨p/2âŸ©âˆ—Obor â†’ Pâˆ—â–¡Qâˆ—[Î±]âŸ¨p/2âŸ©âˆ—Obor â†’ Pâˆ—%
    ?âˆ—áµ’-comm â–· âˆ—áµ’-monoÊ³ Boráµ-open â–· â‡›áµ-eatË¡ â–· â‡›áµ-monoâœ“ (Î» âœ“âˆ™ â†’
    âˆ—áµ’-monoË¡ (dup-â–¡áµ’ MonoQ) â€º âˆ—áµ’-assocÊ³ â€º âˆ—áµ’-monoË¡ (â–¡áµ’-elim MonoQ â€º â¸¨â¸©-á´®â‡’ {Q}) â€º
    âˆ—áµ’-monoÊ³ ?âˆ—áµ’-comm â€º âˆ—áµ’-assocË¡ â€º âˆ—áµ’-monoâœ“Ë¡ (âŠ¢-sem Qâˆ—RâŠ¢P) âœ“âˆ™ â€º
    âˆ—áµ’-monoÊ³ Î» big â†’ -, p , Q , -á´µ, -, (â‰ˆá´¿âº-refl {p} , Q|RâŠ¢âŠ£P) , big) }

  -- Get [ Î± ]á´¸âŸ¨ p âŸ©áµ’ out of Lineá´®áµ’Ê³ with Å¡ p using [ Î± ]á´¸âŸ¨ p /2âº âŸ©áµ’

  []á´¸âŸ¨/2âŸ©áµ’-close :  [ Î± ]á´¸âŸ¨ p /2âº âŸ©áµ’  âˆ—áµ’  Lineá´®áµ’Ê³ (Å¡ p , b , Î± , P)  âŠ¨âœ“
                      âŒœ b â‰¡ tt âŒáµ’Ã—  [ Î± ]á´¸âŸ¨ p âŸ©áµ’
  []á´¸âŸ¨/2âŸ©áµ’-close {b = tt} _ big =  refl , []á´¸âŸ¨âŸ©áµ’-merge-/2 big
  []á´¸âŸ¨/2âŸ©áµ’-close {b = ff} âœ“âˆ™ =  []á´¸âŸ¨âŸ©áµ’-â€ á´¸áµ’-no âœ“âˆ™ â€º Î» ()

  -- Retrieve [ Î± ]á´¸âŸ¨ p âŸ©áµ’ and Boráµ using â¸¨ P â¸©, [ Î± ]á´¸âŸ¨ p /2âº âŸ©áµ’ and Oboráµ

  Oboráµ-close :  â¸¨ P â¸©  âˆ—áµ’  [ Î± ]á´¸âŸ¨ p /2âº âŸ©áµ’  âˆ—áµ’  Oboráµ i Î± p P  âŠ¨ â‡›á´®áµ’Ê³
                   [ Î± ]á´¸âŸ¨ p âŸ©áµ’  âˆ—áµ’  Boráµ i Î± P
  Oboráµ-close =  âˆ—áµ’-assocË¡ â€º â‡›áµÂ¹-make $ âˆ—áµ’-assocÊ³ â€º ?âˆ—áµ’-comm â€º
    âˆ—áµ’-monoË¡ (â†-â—âŸ¨âŸ©-â¤‡á´± oboráµ-close) â€º â¤‡á´±-eatÊ³ â€º â¤‡á´±-monoâœ“ (Î» (i<n , b , Eiâ‰¡) âœ“âˆ™ â†’
    -- Borâˆ—(Pâˆ—[Î±]âŸ¨p/2âŸ©)âˆ—Inv â†’ Borâˆ—(Pâˆ—[Î±]âŸ¨p/2âŸ©)âˆ—Lineâˆ—Inv â†’ â†’ â†’
    -- Borâˆ—([Î±]âŸ¨p/2âŸ©âˆ—Line)âˆ—Pâˆ—Inv â†’ â†’ Borâˆ—[Î±]âŸ¨pâŸ©âˆ—Pâˆ—Inv â†’ Borâˆ—[Î±]âŸ¨pâŸ©âˆ—Inv â†’ â†’
    -- ([Î±]âŸ¨pâŸ©âˆ—Bor)âˆ—Inv
      âˆ—áµ’-monoâœ“Ê³ (Î» âœ“âˆ™ â†’ âˆ—áµ’-monoÊ³ (Smry-rem-< i<n Eiâ‰¡) â€º âˆ—áµ’-assocÊ³ â€º âˆ—áµ’-pushÊ³Â²Ë¡ â€º
      âˆ—áµ’-assocË¡ â€º âˆ—áµ’-monoâœ“Ë¡ ([]á´¸âŸ¨/2âŸ©áµ’-close {b = b}) âœ“âˆ™ â€º âˆƒáµ’âˆ—áµ’-out â€º âˆ‘-case
      Î»{ refl â†’ âˆ—áµ’-monoÊ³ Smry-upd }) âœ“âˆ™ â€º âˆ—áµ’-assocË¡ â€º âˆ—áµ’-monoË¡ âˆ—áµ’-comm) â€º
    â¤‡á´±-param

  -- Retrieve [ Î± ]á´¸âŸ¨ p âŸ©áµ’ and &áµáµ’ using â¸¨ P â¸© and %áµáµ’

  %áµáµ’-close :  â¸¨ P â¸©  âˆ—áµ’  %áµâŸ¨ Î± , p âŸ©áµ’ P  âŠ¨ â‡›á´®áµ’Ê³  [ Î± ]á´¸âŸ¨ p âŸ©áµ’  âˆ—áµ’  &áµâŸ¨ Î± âŸ©áµ’ P
  %áµáµ’-close {p = p} =  âˆ—áµ’â‡’âˆ—áµ’' â€º Î»{ (-, -, âˆ™âŠ‘ , Pb ,
    -, q , Q , -á´µ, -, (pâ‰ˆq , Q|RâŠ¢âŠ£P@(-, Qâˆ—PâŠ¢R)) , â–¡Qâˆ—[Î±]âˆ—OborRc) â†’
    let MonoQ = â¸¨â¸©á´®-Mono {Q} in âˆ—áµ’'â‡’âˆ—áµ’ (-, -, âˆ™âŠ‘ , Pb , â–¡Qâˆ—[Î±]âˆ—OborRc) â–·
    -- Pâˆ—â–¡Qâˆ—[Î±]âŸ¨q/2âŸ©âˆ—Obor â†’ â–¡Qâˆ—Pâˆ—[Î±]âŸ¨q/2âŸ©âˆ—Obor â†’ â†’ â–¡Qâˆ—â–¡Qâˆ—Pâˆ—[Î±]âŸ¨q/2âŸ©âˆ—Obor â†’ â†’ â†’
    -- Qâˆ—Pâˆ—â–¡Qâˆ—[Î±]âŸ¨q/2âŸ©âˆ—Obor â†’ â†’ Râˆ—â–¡Qâˆ—[Î±]âŸ¨q/2âŸ©âˆ—Obor â†’ â–¡Qâˆ—Râˆ—[Î±]âŸ¨q/2âŸ©âˆ—Obor â†’
    -- â–¡Qâˆ—[Î±]âŸ¨qâŸ©âˆ—Bor â†’ [Î±]âŸ¨qâŸ©âˆ—â–¡Qâˆ—Bor â†’ [Î±]âŸ¨pâŸ©âˆ—&
    âŠ¨âœ“â‡’âŠ¨-â‡›áµ Î» âœ“âˆ™ â†’ ?âˆ—áµ’-comm â€º âˆ—áµ’-monoË¡ (dup-â–¡áµ’ MonoQ) â€º âˆ—áµ’-assocÊ³ â€º
    âˆ—áµ’-monoË¡ (â–¡áµ’-elim MonoQ â€º â¸¨â¸©-á´®â‡’ {Q}) â€º âˆ—áµ’-monoÊ³ ?âˆ—áµ’-comm â€º âˆ—áµ’-assocË¡ â€º
    âˆ—áµ’-monoâœ“Ë¡ (âŠ¢-sem Qâˆ—PâŠ¢R) âœ“âˆ™ â€º ?âˆ—áµ’-comm â€º âˆ—áµ’-monoÊ³ Oboráµ-close â€º â‡›áµ-eatË¡ â€º
    â‡›áµ-mono $ ?âˆ—áµ’-comm â€º âˆ—áµ’-mono ([]á´¸âŸ¨âŸ©áµ’-resp $ â‰ˆá´¿âº-sym {p} {q} pâ‰ˆq)
      Î» big â†’ -, Q , -á´µ, -, Q|RâŠ¢âŠ£P , big }

  -- Get â¸¨ P â¸© out of Lineá´®áµ’Ê³ with tt using â€ á´¸áµ’

  â€ á´¸áµ’-back :  â€ á´¸áµ’ Î±  âˆ—áµ’  Lineá´®áµ’Ê³ (pË‡ , tt , Î± , P)  âŠ¨âœ“  â¸¨ P â¸©
  â€ á´¸áµ’-back {pË‡ = Åˆ} {P} _ =  âˆ—áµ’-elimÊ³ $ â¸¨â¸©-Mono {P = P}
  â€ á´¸áµ’-back {pË‡ = Å¡ _} âœ“âˆ™ =  âˆ—áµ’-comm â€º []á´¸âŸ¨âŸ©áµ’-â€ á´¸áµ’-no âœ“âˆ™ â€º Î» ()

  -- Get â¸¨ P â¸© back from Lend using â€ á´¸áµ’

  Lend-back :  â€ á´¸áµ’ Î±  âˆ—áµ’  Lend i Î± P  âŠ¨ â‡›á´®áµ’Ê³  â¸¨ P â¸©
  Lend-back =  â‡›áµÂ¹-make $ âˆ—áµ’-assocÊ³ â€º ?âˆ—áµ’-comm â€º
    âˆ—áµ’-monoË¡ (â†-â—âŸ¨âŸ©-â¤‡á´± {bâ±Ë™ = Î» _ â†’ Îµá´®áµ’Ê³} lend-back) â€º â¤‡á´±-eatÊ³ â€º
    -- -âˆ—â€ âˆ—Inv â†’ â†’ â€ âˆ—Inv â†’ (â€ âˆ—â€ )âˆ—Lineâˆ—Inv â†’ â€ âˆ—â€ âˆ—Lineâˆ—Inv â†’ â†’
    -- (â€ âˆ—Line)âˆ—â€ âˆ—Inv â†’ Pâˆ—â€ âˆ—Inv â†’ Pâˆ—â€ âˆ—Inv â†’ Pâˆ—Inv
    â¤‡á´±-monoâœ“ (Î» (i<n , pË‡ , Eiâ‰¡) âœ“âˆ™ â†’ âˆ—áµ’-elimÊ³ âˆ—áµ’-Mono â€º
      âˆ—áµ’-mono dup-â€ á´¸áµ’ (Smry-rem-< i<n Eiâ‰¡) â€º âˆ—áµ’-assocÊ³ â€º âˆ—áµ’-monoÊ³ ?âˆ—áµ’-comm â€º
      âˆ—áµ’-assocË¡ â€º âˆ—áµ’-monoâœ“Ë¡ (â€ á´¸áµ’-back {pË‡ = pË‡}) âœ“âˆ™ â€º âˆ—áµ’-monoÊ³ Smry-upd) â€º
    â¤‡á´±-param

  -- Get â¸¨ P â¸© back from âŸ¨â€ âŸ©áµ’ using â€ á´¸áµ’

  âŸ¨â€ âŸ©áµ’-back :  â€ á´¸áµ’ Î±  âˆ—áµ’  âŸ¨â€  Î± âŸ©áµ’ P  âŠ¨ â‡›á´®áµ’Ê³  â¸¨ P â¸©
  âŸ¨â€ âŸ©áµ’-back =  âˆ—áµ’â‡’âˆ—áµ’' â€º Î»{ (-, -, âˆ™âŠ‘ , â€ Î±b , -, Q , -á´µ, -, Qâˆ—RâŠ¢P , Qâˆ—LendRc) â†’
    âˆ—áµ’'â‡’âˆ—áµ’ (-, -, âˆ™âŠ‘ , â€ Î±b , Qâˆ—LendRc) â–· ?âˆ—áµ’-comm â–· âˆ—áµ’-monoÊ³ Lend-back â–·
    â‡›áµ-eatË¡ â–· â‡›áµ-monoâœ“ (Î» âœ“âˆ™ â†’ âˆ—áµ’-monoË¡ (â¸¨â¸©-á´®â‡’ {Q}) â€º âŠ¢-sem Qâˆ—RâŠ¢P âœ“âˆ™) }

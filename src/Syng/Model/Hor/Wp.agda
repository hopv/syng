--------------------------------------------------------------------------------
-- Semantic weakest preconditions
--------------------------------------------------------------------------------

{-# OPTIONS --without-K --sized-types #-}

module Syng.Model.Hor.Wp where

open import Base.Level using (Level; _âŠ”á´¸_; 1á´¸)
open import Base.Func using (_$_; _â–·_; _âˆ˜_; _â€º_; id)
open import Base.Few using (âŠ¤; absurd)
open import Base.Eq using (_â‰¡_)
open import Base.Size using (ğ•Š; ğ•Š<; âˆ; !; Â§_)
open import Base.Bool using (ğ”¹; tt; ff)
open import Base.Option using (Â¿_; Åˆ; Å¡_)
open import Base.Prod using (_Ã—_; _,_; -,_)
open import Base.Sum using (Ä©â‚€_; Ä©â‚_)
open import Base.Sety using ()
open import Syng.Lang.Expr using (Type; â—¸_; Exprâˆ; Val; Vâ‡’E; Heap)
open import Syng.Lang.Ktxred using (Redex; Ktxred; Val/Ktxred; val/ktxred)
open import Syng.Lang.Reduce using (_â‡á´¿_; _â‡á´·á´¿âŸ¨_âŸ©_; _â‡á´·á´¿_; _â‡’á´¿âˆ‘; _â‡’á´·á´¿âˆ‘)
open import Syng.Model.Prop.Base using (SPropáµ’; Monoáµ’; _âŠ¨âœ“_; _âŠ¨_; âŠ¨_; âˆ€áµ’-syntax;
  âˆƒáµ’-syntax; âŠ¤áµ’; âŠ¤áµ’â‚€; âŠ¥áµ’â‚€; âŒœ_âŒáµ’Ã—_; âŒœ_âŒáµ’â†’_; _âˆ—áµ’'_; _âˆ—áµ’_; _-âˆ—áµ’'_; _-âˆ—áµ’_; Thunkáµ’;
  Shrunkáµ’; âŠ¨â‡’âŠ¨âœ“; âˆ€áµ’-Mono; âˆ—áµ’â‡’âˆ—áµ’'; âˆ—áµ’'â‡’âˆ—áµ’; âˆ—áµ’-Mono; âˆ—áµ’-mono; âˆ—áµ’-monoâœ“Ë¡; âˆ—áµ’-monoË¡;
  âˆ—áµ’-monoÊ³; âˆ—áµ’-assocË¡; ?âˆ—áµ’-comm; ?âˆ—áµ’-intro; âˆ—áµ’âˆƒáµ’-out; -âˆ—áµ’â‡’-âˆ—áµ’'; -âˆ—áµ’'â‡’-âˆ—áµ’;
  -âˆ—áµ’-Mono; -âˆ—áµ’-monoÊ³; âŠ¨âœ“â‡’âŠ¨--âˆ—áµ’; -âˆ—áµ’-applyË¡; -âˆ—áµ’-eatË¡; â—-Mono; âˆ—áµ’Thunkáµ’-out;
  âˆ—áµ’Shrunkáµ’-out)
open import Syng.Model.Prop.Names using ([âŠ¤]á´ºáµ’)
open import Syng.Model.Fupd.Interp using (âŸ¨_âŸ©â‡›Ë¢'âŸ¨_âŸ©_; âŸ¨_âŸ©â‡›Ë¢âŸ¨_âŸ©_; â‡›áµ’_; â‡›á´ºáµ’_;
  â‡›Ë¢â‡’â‡›Ë¢'; â‡›Ë¢'â‡’â‡›Ë¢; â‡›Ë¢-Mono; â‡›áµ’-Mono; â‡›Ë¢-monoâœ“; â‡›Ë¢-mono; â‡›áµ’-monoâœ“; â‡›áµ’-mono;
  â‡›á´ºáµ’-monoâœ“; â‡›á´ºáµ’-mono; âŠ¨âœ“â‡’âŠ¨-â‡›Ë¢; â‡›á´ºáµ’-intro; â‡›Ë¢-join; â‡›á´ºáµ’-join; â‡›Ë¢-eatË¡; â‡›á´ºáµ’-eatË¡;
  â‡›áµ’â‡’â‡›á´ºáµ’)

private variable
  Å‚ :  Level
  Î¹ Î¹' :  ğ•Š
  b :  ğ”¹
  X Y Z :  Setâ‚€
  T :  Type
  Páµ’ Qáµ’ :  SPropáµ’ Å‚
  Páµ’Ë™ Qáµ’Ë™ :  X â†’ SPropáµ’ Å‚
  Páµ’Ë™Â³ Qáµ’Ë™Â³ :  X â†’ Y â†’ Z â†’ SPropáµ’ Å‚
  v :  X
  red :  Redex T
  kr :  Ktxred T
  vk :  Val/Ktxred T
  e :  Exprâˆ T
  eË‡ :  Â¿ Exprâˆ T

--------------------------------------------------------------------------------
-- áµƒâŸ¨ âŸ©áµ’ :  Semantic atomic weakest precondition

áµƒâŸ¨_âŸ©áµ’ :  Redex T â†’  (Val T â†’ SPropáµ’ Å‚) â†’  SPropáµ’ (1á´¸ âŠ”á´¸ Å‚)
áµƒâŸ¨ red âŸ©áµ’ Páµ’Ë™ =  âˆ€áµ’ H , âŸ¨ H âŸ©â‡›Ë¢âŸ¨ H âŸ© âŒœ (red , H) â‡’á´¿âˆ‘ âŒáµ’Ã—
                   âˆ€áµ’ e , âˆ€áµ’ eË‡ , âˆ€áµ’ H' , âŒœ (e , eË‡ , H') â‡á´¿ (red , H) âŒáµ’â†’
                     âˆƒáµ’ v , âŒœ e â‰¡ Vâ‡’E v Ã— eË‡ â‰¡ Åˆ âŒáµ’Ã—  âŸ¨ H âŸ©â‡›Ë¢âŸ¨ H' âŸ©  Páµ’Ë™ v

--------------------------------------------------------------------------------
-- Wpg :  Weakest precondition generator for a context-redex pair kr

-- It states that the reduction of kr is not stuck
-- and for every next state with e, eË‡, b, we have Qáµ’Ë™ e eË‡ b

-- Wpg' is a variant of Wpg that uses the concrete connectives â‡›Ë¢', -âˆ—áµ’' and
-- âˆ—áµ’', which exposes the definition publicly
-- It is used for the strict positivity check of self-reference

Wpg Wpg' :  Ktxred T â†’  (Exprâˆ T â†’ Â¿ Exprâˆ (â—¸ âŠ¤) â†’ ğ”¹ â†’ SPropáµ’ Å‚) â†’
            SPropáµ’ (1á´¸ âŠ”á´¸ Å‚)
Wpg kr Páµ’Ë™Â³ =  [âŠ¤]á´ºáµ’ -âˆ—áµ’ âˆ€áµ’ H , âŸ¨ H âŸ©â‡›Ë¢âŸ¨ H âŸ© âŒœ (kr , H) â‡’á´·á´¿âˆ‘ âŒáµ’Ã—
  âˆ€áµ’ e , âˆ€áµ’ eË‡ , âˆ€áµ’ H' , âˆ€áµ’ b , âŒœ (e , eË‡ , H') â‡á´·á´¿âŸ¨ b âŸ© (kr , H) âŒáµ’â†’
    âŸ¨ H âŸ©â‡›Ë¢âŸ¨ H' âŸ© [âŠ¤]á´ºáµ’ âˆ—áµ’ Páµ’Ë™Â³ e eË‡ b
Wpg' kr Páµ’Ë™Â³ =  [âŠ¤]á´ºáµ’ -âˆ—áµ’' âˆ€áµ’ H , âŸ¨ H âŸ©â‡›Ë¢'âŸ¨ H âŸ© âŒœ (kr , H) â‡’á´·á´¿âˆ‘ âŒáµ’Ã—
  âˆ€áµ’ e , âˆ€áµ’ eË‡ , âˆ€áµ’ H' , âˆ€áµ’ b , âŒœ (e , eË‡ , H') â‡á´·á´¿âŸ¨ b âŸ© (kr , H) âŒáµ’â†’
    âŸ¨ H âŸ©â‡›Ë¢'âŸ¨ H' âŸ© [âŠ¤]á´ºáµ’ âˆ—áµ’' Páµ’Ë™Â³ e eË‡ b

--------------------------------------------------------------------------------
-- âºâŸ¨ âŸ©á´¾áµ’ etc. :  Semantic partial weakest precondition

-- Wpá´¾ :  âºâŸ¨ âŸ©á´¾áµ’ with the arguments re-ordered

data  Wpá´¾ (Páµ’Ë™ : Val T â†’ SPropáµ’ Å‚) (Î¹ : ğ•Š) :  Val/Ktxred T â†’  SPropáµ’ (1á´¸ âŠ”á´¸ Å‚)

-- âºâŸ¨ âŸ©á´¾áµ’ :  Semantic partial weakest precondition on Val/Ktxred
-- âŸ¨ âŸ©á´¾áµ’ :  âºâŸ¨ âŸ©á´¾áµ’ on Expr
-- âŸ¨ âŸ©á´¾áµ’Ë‚ :  âŸ¨ âŸ©á´¾áµ’Ë‚ under Thunk

âºâŸ¨_âŸ©á´¾áµ’ :  Val/Ktxred T â†’  ğ•Š â†’  (Val T â†’ SPropáµ’ Å‚) â†’  SPropáµ’ (1á´¸ âŠ”á´¸ Å‚)
âºâŸ¨ kr âŸ©á´¾áµ’ Î¹ Páµ’Ë™ =  Wpá´¾ Páµ’Ë™ Î¹ kr

âŸ¨_âŸ©á´¾áµ’ âŸ¨_âŸ©á´¾áµ’Ë‚ :  Exprâˆ T â†’  ğ•Š â†’  (Val T â†’ SPropáµ’ Å‚) â†’  SPropáµ’ (1á´¸ âŠ”á´¸ Å‚)
âŸ¨ e âŸ©á´¾áµ’ Î¹ Páµ’Ë™ =  âºâŸ¨ val/ktxred e âŸ©á´¾áµ’ Î¹ Páµ’Ë™
âŸ¨ e âŸ©á´¾áµ’Ë‚ Î¹ Páµ’Ë™ =  Thunkáµ’ (Î» Î¹' â†’ âŸ¨ e âŸ©á´¾áµ’ Î¹' Páµ’Ë™) Î¹

-- âºâŸ¨ âŸ©á´¾áµ’âŠ¤ :  Semantic partial weakest precondition on Val/Ktxred,
--            without the postcondition, used for forked threads

-- Wpá´¾âŠ¤ :  âºâŸ¨ âŸ©á´¾áµ’âŠ¤ with the arguments re-ordered

data  Wpá´¾âŠ¤ (Î¹ : ğ•Š) :  Val/Ktxred (â—¸ âŠ¤) â†’  SPropáµ’ 1á´¸

âºâŸ¨_âŸ©á´¾áµ’âŠ¤ :  Val/Ktxred (â—¸ âŠ¤) â†’  ğ•Š â†’  SPropáµ’ 1á´¸
âºâŸ¨ vk âŸ©á´¾áµ’âŠ¤ Î¹ =  Wpá´¾âŠ¤ Î¹ vk

-- âŸ¨ âŸ©á´¾áµ’âŠ¤ :  âºâŸ¨ âŸ©á´¾áµ’âŠ¤ on Expr
-- âŸ¨ âŸ©á´¾áµ’âŠ¤Ë‚ :  âŸ¨ âŸ©á´¾áµ’âŠ¤ under Thunk
-- âŸ¨Â¿ âŸ©á´¾áµ’âŠ¤Ë‚ :  âŸ¨ âŸ©á´¾áµ’âŠ¤Ë‚ for Â¿ Expr

âŸ¨_âŸ©á´¾áµ’âŠ¤ âŸ¨_âŸ©á´¾áµ’âŠ¤Ë‚ :  Exprâˆ (â—¸ âŠ¤) â†’  ğ•Š â†’  SPropáµ’ 1á´¸
âŸ¨ e âŸ©á´¾áµ’âŠ¤ Î¹ =  âºâŸ¨ val/ktxred e âŸ©á´¾áµ’âŠ¤ Î¹
âŸ¨ e âŸ©á´¾áµ’âŠ¤Ë‚ Î¹ =  Thunkáµ’ âŸ¨ e âŸ©á´¾áµ’âŠ¤ Î¹

âŸ¨Â¿_âŸ©á´¾áµ’âŠ¤Ë‚ :  Â¿ Exprâˆ (â—¸ âŠ¤) â†’  ğ•Š â†’  SPropáµ’ 1á´¸
âŸ¨Â¿ Åˆ âŸ©á´¾áµ’âŠ¤Ë‚ _ =  âŠ¤áµ’
âŸ¨Â¿ Å¡ e âŸ©á´¾áµ’âŠ¤Ë‚ Î¹ =  âŸ¨ e âŸ©á´¾áµ’âŠ¤Ë‚ Î¹

data  Wpá´¾âŠ¤ Î¹  where
  -- For a value
  âºâŸ¨âŸ©á´¾áµ’âŠ¤-val :  âŠ¨  âºâŸ¨ Ä©â‚€ v âŸ©á´¾áµ’âŠ¤ Î¹
  -- For a contex-redex pair, with coinductive self-reference
  âºâŸ¨âŸ©á´¾áµ’âŠ¤-kr' :  Wpg' kr (Î» e eË‡ _ â†’ âŸ¨ e âŸ©á´¾áµ’âŠ¤Ë‚ Î¹ âˆ—áµ’' âŸ¨Â¿ eË‡ âŸ©á´¾áµ’âŠ¤Ë‚ Î¹)  âŠ¨
                âºâŸ¨ Ä©â‚ kr âŸ©á´¾áµ’âŠ¤ Î¹

data  Wpá´¾ Páµ’Ë™ Î¹  where
  -- For a value
  âºâŸ¨âŸ©á´¾áµ’-val :  â‡›á´ºáµ’ Páµ’Ë™ v  âŠ¨  âºâŸ¨ Ä©â‚€ v âŸ©á´¾áµ’ Î¹ Páµ’Ë™
  -- For a contex-redex pair, with coinductive self-reference
  âºâŸ¨âŸ©á´¾áµ’-kr' :  Wpg' kr (Î» e eË‡ _ â†’ âŸ¨ e âŸ©á´¾áµ’Ë‚ Î¹ Páµ’Ë™ âˆ—áµ’' âŸ¨Â¿ eË‡ âŸ©á´¾áµ’âŠ¤Ë‚ Î¹)  âŠ¨
               âºâŸ¨ Ä©â‚ kr âŸ©á´¾áµ’ Î¹ Páµ’Ë™

--------------------------------------------------------------------------------
-- âºâŸ¨ âŸ©áµ€áµ’ etc. :  Semantic total weakest precondition

-- Wpáµ€ :  âºâŸ¨ âŸ©áµ€áµ’ with the arguments re-ordered

data  Wpáµ€ (Páµ’Ë™ : Val T â†’ SPropáµ’ Å‚) (Î¹ : ğ•Š) :  Val/Ktxred T â†’  SPropáµ’ (1á´¸ âŠ”á´¸ Å‚)

-- âºâŸ¨ âŸ©áµ€áµ’ :  Semantic total weakest precondition on Val/Ktxred
-- âŸ¨ âŸ©áµ€áµ’ :  âºâŸ¨ âŸ©áµ€áµ’ on Expr
-- âŸ¨ âŸ©Ë‚áµ€áµ’ :  âŸ¨ âŸ©áµ€áµ’ under Shrunk

-- We use Shrunk here for induction based semantically on the size, rather than
-- only on the syntactic structure.

âºâŸ¨_âŸ©áµ€áµ’ :  Val/Ktxred T â†’  ğ•Š â†’  (Val T â†’ SPropáµ’ Å‚) â†’  SPropáµ’ (1á´¸ âŠ”á´¸ Å‚)
âºâŸ¨ kr âŸ©áµ€áµ’ Î¹ Páµ’Ë™ =  Wpáµ€ Páµ’Ë™ Î¹ kr

âŸ¨_âŸ©áµ€áµ’ âŸ¨_âŸ©áµ€áµ’Ë‚ :  Exprâˆ T â†’  ğ•Š â†’  (Val T â†’ SPropáµ’ Å‚) â†’  SPropáµ’ (1á´¸ âŠ”á´¸ Å‚)
âŸ¨ e âŸ©áµ€áµ’ Î¹ Páµ’Ë™ =  âºâŸ¨ val/ktxred e âŸ©áµ€áµ’ Î¹ Páµ’Ë™
âŸ¨ e âŸ©áµ€áµ’Ë‚ Î¹ Páµ’Ë™ =  Shrunkáµ’ (Î» Î¹' â†’ âŸ¨ e âŸ©áµ€áµ’ Î¹' Páµ’Ë™) Î¹

-- âºâŸ¨ âŸ©áµ€áµ’âŠ¤ :  Semantic total total precondition on Val/Ktxred,
--               without the postcondition, used for forked threads

-- Wpáµ€âŠ¤ :  âºâŸ¨ âŸ©áµ€áµ’âŠ¤ with the arguments re-ordered

data  Wpáµ€âŠ¤ (Î¹ : ğ•Š) :  Val/Ktxred (â—¸ âŠ¤) â†’  SPropáµ’ 1á´¸

âºâŸ¨_âŸ©áµ€áµ’âŠ¤ :  Val/Ktxred (â—¸ âŠ¤) â†’  ğ•Š â†’  SPropáµ’ 1á´¸
âºâŸ¨ vk âŸ©áµ€áµ’âŠ¤ Î¹ =  Wpáµ€âŠ¤ Î¹ vk

-- âŸ¨ âŸ©áµ€áµ’âŠ¤ :  âºâŸ¨ âŸ©áµ€áµ’âŠ¤ on Expr
-- âŸ¨ âŸ©áµ€áµ’âŠ¤Ë‚ :  âŸ¨ âŸ©áµ€áµ’âŠ¤ under Shrunk
-- âŸ¨Â¿ âŸ©á´¾áµ’âŠ¤Ë‚ :  âŸ¨ âŸ©á´¾áµ’âŠ¤Ë‚ for Â¿ Expr

âŸ¨_âŸ©áµ€áµ’âŠ¤ âŸ¨_âŸ©áµ€áµ’âŠ¤Ë‚ :  Exprâˆ (â—¸ âŠ¤) â†’  ğ•Š â†’  SPropáµ’ 1á´¸
âŸ¨ e âŸ©áµ€áµ’âŠ¤ Î¹ =  âºâŸ¨ val/ktxred e âŸ©áµ€áµ’âŠ¤ Î¹
âŸ¨ e âŸ©áµ€áµ’âŠ¤Ë‚ Î¹ =  Shrunkáµ’ âŸ¨ e âŸ©áµ€áµ’âŠ¤ Î¹

âŸ¨Â¿_âŸ©áµ€áµ’âŠ¤Ë‚ :  Â¿ Exprâˆ (â—¸ âŠ¤) â†’  ğ•Š â†’  SPropáµ’ 1á´¸
âŸ¨Â¿ Åˆ âŸ©áµ€áµ’âŠ¤Ë‚ _ =  âŠ¤áµ’
âŸ¨Â¿ Å¡ e âŸ©áµ€áµ’âŠ¤Ë‚ Î¹ =  âŸ¨ e âŸ©áµ€áµ’âŠ¤Ë‚ Î¹

data  Wpáµ€âŠ¤ Î¹  where
  -- For a value
  âºâŸ¨âŸ©áµ€áµ’âŠ¤-val :  âŠ¨  âºâŸ¨ Ä©â‚€ v âŸ©áµ€áµ’âŠ¤ Î¹
  -- For a contex-redex pair, with inductive self-reference
  âºâŸ¨âŸ©áµ€áµ’âŠ¤-kr' :  Wpg' kr (Î» e eË‡ _ â†’ âŸ¨ e âŸ©áµ€áµ’âŠ¤Ë‚ Î¹ âˆ—áµ’' âŸ¨Â¿ eË‡ âŸ©áµ€áµ’âŠ¤Ë‚ Î¹)  âŠ¨
                âºâŸ¨ Ä©â‚ kr âŸ©áµ€áµ’âŠ¤ Î¹

data  Wpáµ€ Páµ’Ë™ Î¹  where
  -- For a value
  âºâŸ¨âŸ©áµ€áµ’-val :  â‡›á´ºáµ’ Páµ’Ë™ v  âŠ¨  âºâŸ¨ Ä©â‚€ v âŸ©áµ€áµ’ Î¹ Páµ’Ë™
  -- For a contex-redex pair, with inductive self-reference
  âºâŸ¨âŸ©áµ€áµ’-kr' :  Wpg' kr (Î» e eË‡ _ â†’ âŸ¨ e âŸ©áµ€áµ’Ë‚ Î¹ Páµ’Ë™ âˆ—áµ’' âŸ¨Â¿ eË‡ âŸ©áµ€áµ’âŠ¤Ë‚ Î¹)  âŠ¨
               âºâŸ¨ Ä©â‚ kr âŸ©áµ€áµ’ Î¹ Páµ’Ë™

--------------------------------------------------------------------------------
-- âºâŸ¨ âŸ©âˆáµ’ etc. :  Semantic infinite weakest precondition

-- Wpâˆ :  âºâŸ¨ âŸ©âˆáµ’ with the arguments re-ordered

data  Wpâˆ {T} (Î¹ Î¹' : ğ•Š) :  Val/Ktxred T â†’  SPropáµ’ 1á´¸

-- âºâŸ¨ âŸ©âˆáµ’ :  Semantic total weakest precondition on Val/Ktxred
-- âŸ¨ âŸ©âˆáµ’ :  âºâŸ¨ âŸ©âˆáµ’ on Expr
-- âŸ¨ âŸ©âˆáµ’Ë‚Ë¡ :  âŸ¨ âŸ©âˆáµ’ under Shrunk for the left-hand size
-- âŸ¨ âŸ©âˆáµ’Ë‚Ê³ :  âŸ¨ âŸ©âˆáµ’ under Thunk for the right-hand size,
--            resetting the right-hand size to âˆ
-- âŸ¨ âŸ©âˆáµ’Ë‚âŸ¨ âŸ© :  âŸ¨ âŸ©âˆáµ’Ë‚Ë¡ or âŸ¨ âŸ©âˆáµ’Ë‚Ê³, depending on the boolean argument

âºâŸ¨_âŸ©âˆáµ’ :  Val/Ktxred T â†’  ğ•Š â†’  ğ•Š â†’  SPropáµ’ 1á´¸
âºâŸ¨ kr âŸ©âˆáµ’ Î¹ Î¹' =  Wpâˆ Î¹ Î¹' kr

âŸ¨_âŸ©âˆáµ’ âŸ¨_âŸ©âˆáµ’Ë‚Ë¡ :  Exprâˆ T â†’  ğ•Š â†’  ğ•Š â†’  SPropáµ’ 1á´¸
âŸ¨ e âŸ©âˆáµ’ Î¹ Î¹' =  âºâŸ¨ val/ktxred e âŸ©âˆáµ’ Î¹ Î¹'
âŸ¨ e âŸ©âˆáµ’Ë‚Ë¡ Î¹ Î¹' =  Shrunkáµ’ (Î» Î¹â» â†’ âŸ¨ e âŸ©âˆáµ’ Î¹â» Î¹') Î¹

âŸ¨_âŸ©âˆáµ’Ë‚Ê³ :  Exprâˆ T â†’  ğ•Š â†’  SPropáµ’ 1á´¸
âŸ¨ e âŸ©âˆáµ’Ë‚Ê³ Î¹' =  Thunkáµ’ (âŸ¨ e âŸ©âˆáµ’ âˆ) Î¹'

âŸ¨_âŸ©âˆáµ’Ë‚âŸ¨_âŸ© :  Exprâˆ T â†’  ğ”¹ â†’  ğ•Š â†’  ğ•Š â†’  SPropáµ’ 1á´¸
âŸ¨ e âŸ©âˆáµ’Ë‚âŸ¨ ff âŸ© Î¹ Î¹' =  âŸ¨ e âŸ©âˆáµ’Ë‚Ë¡ Î¹ Î¹'
âŸ¨ e âŸ©âˆáµ’Ë‚âŸ¨ tt âŸ© _ Î¹' =  âŸ¨ e âŸ©âˆáµ’Ë‚Ê³ Î¹'

data  Wpâˆ Î¹ Î¹'  where
  -- For a value
  âºâŸ¨âŸ©âˆáµ’-val :  â‡›á´ºáµ’ âŠ¥áµ’â‚€  âŠ¨  âºâŸ¨ Ä©â‚€ v âŸ©âˆáµ’ Î¹ Î¹'
  -- For a context-redex pair, with self-reference inductive/coinductive
  -- in the case the event has not / has occurred
  âºâŸ¨âŸ©âˆáµ’-kr' :  Wpg' kr (Î» e eË‡ b â†’ âŸ¨ e âŸ©âˆáµ’Ë‚âŸ¨ b âŸ© Î¹ Î¹' âˆ—áµ’' âŸ¨Â¿ eË‡ âŸ©áµ€áµ’âŠ¤Ë‚ Î¹)  âŠ¨
               âºâŸ¨ Ä©â‚ kr âŸ©âˆáµ’ Î¹ Î¹'

--------------------------------------------------------------------------------
-- Lemmas on the atomic, partial, total, and infinite weakest preconditions

abstract

  -- Invert âºâŸ¨âŸ©á´¾/áµ€áµ’-val and âºâŸ¨âŸ©âˆáµ’-val

  âºâŸ¨âŸ©á´¾áµ’-valâ»Â¹ :  âºâŸ¨ Ä©â‚€ v âŸ©á´¾áµ’ Î¹ Páµ’Ë™  âŠ¨ â‡›á´ºáµ’  Páµ’Ë™ v
  âºâŸ¨âŸ©á´¾áµ’-valâ»Â¹ (âºâŸ¨âŸ©á´¾áµ’-val â‡›Pv) =  â‡›Pv

  âºâŸ¨âŸ©áµ€áµ’-valâ»Â¹ :  âºâŸ¨ Ä©â‚€ v âŸ©áµ€áµ’ Î¹ Páµ’Ë™  âŠ¨ â‡›á´ºáµ’  Páµ’Ë™ v
  âºâŸ¨âŸ©áµ€áµ’-valâ»Â¹ (âºâŸ¨âŸ©áµ€áµ’-val â‡›Pv) =  â‡›Pv

  âºâŸ¨âŸ©âˆáµ’-valâ»Â¹ :  âºâŸ¨ Ä©â‚€ v âŸ©âˆáµ’ Î¹ Î¹'  âŠ¨ â‡›á´ºáµ’  âŠ¥áµ’â‚€
  âºâŸ¨âŸ©âˆáµ’-valâ»Â¹ (âºâŸ¨âŸ©âˆáµ’-val â‡›âŠ¥) =  â‡›âŠ¥

  -- Conversion between Wpg and Wpg'

  Wpgâ‡’Wpg' :  Wpg kr Páµ’Ë™Â³  âŠ¨  Wpg' kr Páµ’Ë™Â³
  Wpgâ‡’Wpg' =  -âˆ—áµ’-monoÊ³ (Î» big H â†’ big H â–· (â‡›Ë¢-mono Î» (krHâ‡’ , big) â†’ krHâ‡’ ,
    Î» e eË‡ H' b eeË‡H'â‡b â†’ big e eË‡ H' b eeË‡H'â‡b â–· â‡›Ë¢-mono âˆ—áµ’â‡’âˆ—áµ’' â–· â‡›Ë¢â‡’â‡›Ë¢') â–·
    â‡›Ë¢â‡’â‡›Ë¢') â€º -âˆ—áµ’â‡’-âˆ—áµ’'

  Wpg'â‡’Wpg :  Wpg' kr Páµ’Ë™Â³  âŠ¨  Wpg kr Páµ’Ë™Â³
  Wpg'â‡’Wpg =  -âˆ—áµ’'â‡’-âˆ—áµ’ {Qáµ’ = âˆ€áµ’ H , âŸ¨ H âŸ©â‡›Ë¢'âŸ¨ H âŸ© _} â€º
    -âˆ—áµ’-monoÊ³ Î» big H â†’ big H â–· â‡›Ë¢'â‡’â‡›Ë¢ â–· â‡›Ë¢-mono Î» (krHâ‡’ , big) â†’ krHâ‡’ ,
    Î» e eË‡ H' b eeË‡H'â‡b â†’ big e eË‡ H' b eeË‡H'â‡b â–· â‡›Ë¢'â‡’â‡›Ë¢ â–· â‡›Ë¢-mono âˆ—áµ’'â‡’âˆ—áµ’

  -- Monotonicity of Wpg

  Wpg-mono :  (âˆ€{e eË‡ b} â†’  Páµ’Ë™Â³ e eË‡ b  âŠ¨  Qáµ’Ë™Â³ e eË‡ b)  â†’
                Wpg kr Páµ’Ë™Â³  âŠ¨  Wpg kr Qáµ’Ë™Â³
  Wpg-mono PeeË‡bâŠ¨QeeË‡b =  -âˆ—áµ’-monoÊ³ (Î» big H â†’ big H â–· â‡›Ë¢-mono
    Î» (krHâ‡’ , big) â†’ krHâ‡’ , Î» e eË‡ H' b eeË‡H'â‡b â†’ big e eË‡ H' b eeË‡H'â‡b â–·
    â‡›Ë¢-mono (âˆ—áµ’-monoÊ³ PeeË‡bâŠ¨QeeË‡b))

  -- Modified âºâŸ¨âŸ©á´¾/áµ€/âˆáµ’-kr'

  âºâŸ¨âŸ©á´¾áµ’-kr :  Wpg kr (Î» e eË‡ _ â†’ âŸ¨ e âŸ©á´¾áµ’Ë‚ Î¹ Páµ’Ë™ âˆ—áµ’ âŸ¨Â¿ eË‡ âŸ©á´¾áµ’âŠ¤Ë‚ Î¹)  âŠ¨
              âºâŸ¨ Ä©â‚ kr âŸ©á´¾áµ’ Î¹ Páµ’Ë™
  âºâŸ¨âŸ©á´¾áµ’-kr =  Wpg-mono âˆ—áµ’â‡’âˆ—áµ’' â€º Wpgâ‡’Wpg' â€º âºâŸ¨âŸ©á´¾áµ’-kr'

  âºâŸ¨âŸ©áµ€áµ’-kr :  Wpg kr (Î» e eË‡ _ â†’ âŸ¨ e âŸ©áµ€áµ’Ë‚ Î¹ Páµ’Ë™ âˆ—áµ’ âŸ¨Â¿ eË‡ âŸ©áµ€áµ’âŠ¤Ë‚ Î¹)  âŠ¨
              âºâŸ¨ Ä©â‚ kr âŸ©áµ€áµ’ Î¹ Páµ’Ë™
  âºâŸ¨âŸ©áµ€áµ’-kr =  Wpg-mono âˆ—áµ’â‡’âˆ—áµ’' â€º Wpgâ‡’Wpg' â€º âºâŸ¨âŸ©áµ€áµ’-kr'

  âºâŸ¨âŸ©âˆáµ’-kr :  Wpg kr (Î» e eË‡ b â†’ âŸ¨ e âŸ©âˆáµ’Ë‚âŸ¨ b âŸ© Î¹ Î¹' âˆ—áµ’ âŸ¨Â¿ eË‡ âŸ©áµ€áµ’âŠ¤Ë‚ Î¹)  âŠ¨
              âºâŸ¨ Ä©â‚ kr âŸ©âˆáµ’ Î¹ Î¹'
  âºâŸ¨âŸ©âˆáµ’-kr =  Wpg-mono âˆ—áµ’â‡’âˆ—áµ’' â€º Wpgâ‡’Wpg' â€º âºâŸ¨âŸ©âˆáµ’-kr'

  -- Invert âºâŸ¨âŸ©á´¾/áµ€áµ’-kr

  âºâŸ¨âŸ©á´¾áµ’-krâ»Â¹ :  âºâŸ¨ Ä©â‚ kr âŸ©á´¾áµ’ Î¹ Páµ’Ë™  âŠ¨
                Wpg kr (Î» e eË‡ _ â†’ âŸ¨ e âŸ©á´¾áµ’Ë‚ Î¹ Páµ’Ë™ âˆ—áµ’ âŸ¨Â¿ eË‡ âŸ©á´¾áµ’âŠ¤Ë‚ Î¹)
  âºâŸ¨âŸ©á´¾áµ’-krâ»Â¹ (âºâŸ¨âŸ©á´¾áµ’-kr' big) =  big â–· Wpg'â‡’Wpg â–· Wpg-mono âˆ—áµ’'â‡’âˆ—áµ’

  âºâŸ¨âŸ©áµ€áµ’-krâ»Â¹ :  âºâŸ¨ Ä©â‚ kr âŸ©áµ€áµ’ Î¹ Páµ’Ë™  âŠ¨
                Wpg kr (Î» e eË‡ _ â†’ âŸ¨ e âŸ©áµ€áµ’Ë‚ Î¹ Páµ’Ë™ âˆ—áµ’ âŸ¨Â¿ eË‡ âŸ©áµ€áµ’âŠ¤Ë‚ Î¹)
  âºâŸ¨âŸ©áµ€áµ’-krâ»Â¹ (âºâŸ¨âŸ©áµ€áµ’-kr' big) =  big â–· Wpg'â‡’Wpg â–· Wpg-mono âˆ—áµ’'â‡’âˆ—áµ’

  âºâŸ¨âŸ©âˆáµ’-krâ»Â¹ :  âºâŸ¨ Ä©â‚ kr âŸ©âˆáµ’ Î¹ Î¹'  âŠ¨
                Wpg kr (Î» e eË‡ b â†’ âŸ¨ e âŸ©âˆáµ’Ë‚âŸ¨ b âŸ© Î¹ Î¹' âˆ—áµ’ âŸ¨Â¿ eË‡ âŸ©áµ€áµ’âŠ¤Ë‚ Î¹)
  âºâŸ¨âŸ©âˆáµ’-krâ»Â¹ (âºâŸ¨âŸ©âˆáµ’-kr' big) =  big â–· Wpg'â‡’Wpg â–· Wpg-mono âˆ—áµ’'â‡’âˆ—áµ’

  -- Conversion between âºâŸ¨âŸ©á´¾/áµ€áµ’âŠ¤ and âºâŸ¨âŸ©á´¾/áµ€áµ’ Î» _ â†’ âŠ¤áµ’â‚€

  âºâŸ¨âŸ©á´¾áµ’âŠ¤â‡’âºâŸ¨âŸ©á´¾áµ’ :  âºâŸ¨ vk âŸ©á´¾áµ’âŠ¤ Î¹  âŠ¨  âºâŸ¨ vk âŸ©á´¾áµ’ Î¹ Î» _ â†’ âŠ¤áµ’â‚€
  âºâŸ¨âŸ©á´¾áµ’âŠ¤â‡’âºâŸ¨âŸ©á´¾áµ’ âºâŸ¨âŸ©á´¾áµ’âŠ¤-val =  âºâŸ¨âŸ©á´¾áµ’-val $ â‡›á´ºáµ’-intro _
  âºâŸ¨âŸ©á´¾áµ’âŠ¤â‡’âºâŸ¨âŸ©á´¾áµ’ (âºâŸ¨âŸ©á´¾áµ’âŠ¤-kr' big) =  big â–· Wpg'â‡’Wpg â–· Wpg-mono (âˆ—áµ’'â‡’âˆ—áµ’ â€º
    âˆ—áµ’-monoË¡ Î» big â†’ Î»{ .! â†’ âºâŸ¨âŸ©á´¾áµ’âŠ¤â‡’âºâŸ¨âŸ©á´¾áµ’ (big .!) }) â–· âºâŸ¨âŸ©á´¾áµ’-kr

  âºâŸ¨âŸ©áµ€áµ’âŠ¤â‡’âºâŸ¨âŸ©áµ€áµ’ :  âºâŸ¨ vk âŸ©áµ€áµ’âŠ¤ Î¹  âŠ¨  âºâŸ¨ vk âŸ©áµ€áµ’ Î¹ Î» _ â†’ âŠ¤áµ’â‚€
  âºâŸ¨âŸ©áµ€áµ’âŠ¤â‡’âºâŸ¨âŸ©áµ€áµ’ âºâŸ¨âŸ©áµ€áµ’âŠ¤-val =  âºâŸ¨âŸ©áµ€áµ’-val $ â‡›á´ºáµ’-intro _
  âºâŸ¨âŸ©áµ€áµ’âŠ¤â‡’âºâŸ¨âŸ©áµ€áµ’ (âºâŸ¨âŸ©áµ€áµ’âŠ¤-kr' big) =  big â–· Wpg'â‡’Wpg â–· Wpg-mono (âˆ—áµ’'â‡’âˆ—áµ’ â€º
    âˆ—áµ’-monoË¡ Î»{ (Â§ big) â†’ Â§ âºâŸ¨âŸ©áµ€áµ’âŠ¤â‡’âºâŸ¨âŸ©áµ€áµ’ big }) â–· âºâŸ¨âŸ©áµ€áµ’-kr

  âºâŸ¨âŸ©á´¾áµ’â‡’âºâŸ¨âŸ©á´¾áµ’âŠ¤ :  âºâŸ¨ vk âŸ©á´¾áµ’ Î¹ Páµ’Ë™  âŠ¨  âºâŸ¨ vk âŸ©á´¾áµ’âŠ¤ Î¹
  âºâŸ¨âŸ©á´¾áµ’â‡’âºâŸ¨âŸ©á´¾áµ’âŠ¤ {vk = Ä©â‚€ _} _ =  âºâŸ¨âŸ©á´¾áµ’âŠ¤-val
  âºâŸ¨âŸ©á´¾áµ’â‡’âºâŸ¨âŸ©á´¾áµ’âŠ¤ {vk = Ä©â‚ _} big =  big â–· âºâŸ¨âŸ©á´¾áµ’-krâ»Â¹ â–· Wpg-mono
    (âˆ—áµ’-monoË¡ (Î» big â†’ Î»{ .! {Î¹'} â†’ âºâŸ¨âŸ©á´¾áµ’â‡’âºâŸ¨âŸ©á´¾áµ’âŠ¤ (big .! {Î¹'}) }) â€º âˆ—áµ’â‡’âˆ—áµ’') â–·
    Wpgâ‡’Wpg' â–· âºâŸ¨âŸ©á´¾áµ’âŠ¤-kr'

  âºâŸ¨âŸ©áµ€áµ’â‡’âºâŸ¨âŸ©áµ€áµ’âŠ¤ :  âºâŸ¨ vk âŸ©áµ€áµ’ Î¹ Páµ’Ë™  âŠ¨  âºâŸ¨ vk âŸ©áµ€áµ’âŠ¤ Î¹
  âºâŸ¨âŸ©áµ€áµ’â‡’âºâŸ¨âŸ©áµ€áµ’âŠ¤ {vk = Ä©â‚€ _} _ =  âºâŸ¨âŸ©áµ€áµ’âŠ¤-val
  âºâŸ¨âŸ©áµ€áµ’â‡’âºâŸ¨âŸ©áµ€áµ’âŠ¤ {vk = Ä©â‚ _} big =  big â–· âºâŸ¨âŸ©áµ€áµ’-krâ»Â¹ â–· Wpg-mono (âˆ—áµ’-monoË¡
    (Î»{ (Â§ big) â†’ Â§ âºâŸ¨âŸ©áµ€áµ’â‡’âºâŸ¨âŸ©áµ€áµ’âŠ¤ big }) â€º âˆ—áµ’â‡’âˆ—áµ’') â–· Wpgâ‡’Wpg' â–· âºâŸ¨âŸ©áµ€áµ’âŠ¤-kr'

  -- Monoáµ’ for áµƒâŸ¨âŸ©áµ’, âºâŸ¨âŸ©á´¾/áµ€áµ’, âºâŸ¨âŸ©âˆáµ’ and âºâŸ¨âŸ©á´¾/áµ€áµ’âŠ¤

  áµƒâŸ¨âŸ©áµ’-Mono :  Monoáµ’ $ áµƒâŸ¨ red âŸ©áµ’ Páµ’Ë™
  áµƒâŸ¨âŸ©áµ’-Mono aâŠ‘b âŸ¨redâŸ©P H =  âŸ¨redâŸ©P H â–· â‡›Ë¢-Mono aâŠ‘b

  âºâŸ¨âŸ©á´¾áµ’-Mono :  Monoáµ’ $ âºâŸ¨ vk âŸ©á´¾áµ’ Î¹ Páµ’Ë™
  âºâŸ¨âŸ©á´¾áµ’-Mono {vk = Ä©â‚€ _} aâŠ‘b =  âºâŸ¨âŸ©á´¾áµ’-valâ»Â¹ â€º -âˆ—áµ’-Mono aâŠ‘b â€º âºâŸ¨âŸ©á´¾áµ’-val
  âºâŸ¨âŸ©á´¾áµ’-Mono {vk = Ä©â‚ _} aâŠ‘b =  âºâŸ¨âŸ©á´¾áµ’-krâ»Â¹ â€º -âˆ—áµ’-Mono aâŠ‘b â€º âºâŸ¨âŸ©á´¾áµ’-kr

  âºâŸ¨âŸ©áµ€áµ’-Mono :  Monoáµ’ $ âºâŸ¨ vk âŸ©áµ€áµ’ Î¹ Páµ’Ë™
  âºâŸ¨âŸ©áµ€áµ’-Mono {vk = Ä©â‚€ _} aâŠ‘b =  âºâŸ¨âŸ©áµ€áµ’-valâ»Â¹ â€º -âˆ—áµ’-Mono aâŠ‘b â€º âºâŸ¨âŸ©áµ€áµ’-val
  âºâŸ¨âŸ©áµ€áµ’-Mono {vk = Ä©â‚ _} aâŠ‘b =  âºâŸ¨âŸ©áµ€áµ’-krâ»Â¹ â€º -âˆ—áµ’-Mono aâŠ‘b â€º âºâŸ¨âŸ©áµ€áµ’-kr

  âºâŸ¨âŸ©âˆáµ’-Mono :  Monoáµ’ $ âºâŸ¨ vk âŸ©âˆáµ’ Î¹ Î¹'
  âºâŸ¨âŸ©âˆáµ’-Mono {vk = Ä©â‚€ _} aâŠ‘b =  âºâŸ¨âŸ©âˆáµ’-valâ»Â¹ â€º -âˆ—áµ’-Mono aâŠ‘b â€º âºâŸ¨âŸ©âˆáµ’-val
  âºâŸ¨âŸ©âˆáµ’-Mono {vk = Ä©â‚ _} aâŠ‘b =  âºâŸ¨âŸ©âˆáµ’-krâ»Â¹ â€º -âˆ—áµ’-Mono aâŠ‘b â€º âºâŸ¨âŸ©âˆáµ’-kr

  âºâŸ¨âŸ©á´¾áµ’âŠ¤-Mono :  Monoáµ’ $ âºâŸ¨ vk âŸ©á´¾áµ’âŠ¤ Î¹
  âºâŸ¨âŸ©á´¾áµ’âŠ¤-Mono aâŠ‘b =  âºâŸ¨âŸ©á´¾áµ’âŠ¤â‡’âºâŸ¨âŸ©á´¾áµ’ â€º âºâŸ¨âŸ©á´¾áµ’-Mono aâŠ‘b â€º âºâŸ¨âŸ©á´¾áµ’â‡’âºâŸ¨âŸ©á´¾áµ’âŠ¤

  âºâŸ¨âŸ©áµ€áµ’âŠ¤-Mono :  Monoáµ’ $ âºâŸ¨ vk âŸ©áµ€áµ’âŠ¤ Î¹
  âºâŸ¨âŸ©áµ€áµ’âŠ¤-Mono aâŠ‘b =  âºâŸ¨âŸ©áµ€áµ’âŠ¤â‡’âºâŸ¨âŸ©áµ€áµ’ â€º âºâŸ¨âŸ©áµ€áµ’-Mono aâŠ‘b â€º âºâŸ¨âŸ©áµ€áµ’â‡’âºâŸ¨âŸ©áµ€áµ’âŠ¤

  -- Utility :  Monoáµ’ for âˆ€áµ’ â‡›Ë¢

  âˆ€áµ’â‡›Ë¢-Mono :  Monoáµ’ $ âˆ€áµ’ H , âŸ¨ H âŸ©â‡›Ë¢âŸ¨ H âŸ© Páµ’Ë™ H
  âˆ€áµ’â‡›Ë¢-Mono =  âˆ€áµ’-Mono Î» _ â†’ â‡›Ë¢-Mono

  -- Monotonicity of áµƒâŸ¨âŸ©áµ’ and âºâŸ¨âŸ©á´¾/áµ€áµ’

  áµƒâŸ¨âŸ©áµ’-monoâœ“ :  (âˆ€ v â†’ Páµ’Ë™ v âŠ¨âœ“ Qáµ’Ë™ v) â†’  áµƒâŸ¨ red âŸ©áµ’ Páµ’Ë™ âŠ¨ áµƒâŸ¨ red âŸ©áµ’ Qáµ’Ë™
  áµƒâŸ¨âŸ©áµ’-monoâœ“ PvâŠ¨âœ“Qv big H =  big H â–· â‡›Ë¢-mono Î» (redHâ‡’ , big) â†’ redHâ‡’ ,
    Î» e eË‡ H' eeË‡H'â‡ â†’ big e eË‡ H' eeË‡H'â‡ â–· Î» (-, â‰¡vÅˆ , big) â†’ -, â‰¡vÅˆ ,
    big â–· â‡›Ë¢-monoâœ“ (PvâŠ¨âœ“Qv _)

  áµƒâŸ¨âŸ©áµ’-mono :  (âˆ€ v â†’ Páµ’Ë™ v âŠ¨ Qáµ’Ë™ v) â†’  áµƒâŸ¨ red âŸ©áµ’ Páµ’Ë™ âŠ¨ áµƒâŸ¨ red âŸ©áµ’ Qáµ’Ë™
  áµƒâŸ¨âŸ©áµ’-mono =  (âŠ¨â‡’âŠ¨âœ“ âˆ˜_) â€º áµƒâŸ¨âŸ©áµ’-monoâœ“

  âºâŸ¨âŸ©á´¾áµ’-monoâœ“ :  (âˆ€ v â†’ Páµ’Ë™ v âŠ¨âœ“ Qáµ’Ë™ v) â†’  âºâŸ¨ vk âŸ©á´¾áµ’ Î¹ Páµ’Ë™ âŠ¨ âºâŸ¨ vk âŸ©á´¾áµ’ Î¹ Qáµ’Ë™
  âºâŸ¨âŸ©á´¾áµ’-monoâœ“ {vk = Ä©â‚€ _} PvâŠ¨âœ“Qv =  âºâŸ¨âŸ©á´¾áµ’-valâ»Â¹ â€º â‡›á´ºáµ’-monoâœ“ (PvâŠ¨âœ“Qv _) â€º
    âºâŸ¨âŸ©á´¾áµ’-val
  âºâŸ¨âŸ©á´¾áµ’-monoâœ“ {vk = Ä©â‚ _} PvâŠ¨âœ“Qv =  âºâŸ¨âŸ©á´¾áµ’-krâ»Â¹ â€º Wpg-mono (âˆ—áµ’-monoË¡ Î» big â†’
    Î»{ .! â†’ âºâŸ¨âŸ©á´¾áµ’-monoâœ“ PvâŠ¨âœ“Qv $ big .! }) â€º âºâŸ¨âŸ©á´¾áµ’-kr

  âºâŸ¨âŸ©á´¾áµ’-mono :  (âˆ€ v â†’ Páµ’Ë™ v âŠ¨ Qáµ’Ë™ v) â†’  âºâŸ¨ vk âŸ©á´¾áµ’ Î¹ Páµ’Ë™ âŠ¨ âºâŸ¨ vk âŸ©á´¾áµ’ Î¹ Qáµ’Ë™
  âºâŸ¨âŸ©á´¾áµ’-mono =  (âŠ¨â‡’âŠ¨âœ“ âˆ˜_) â€º âºâŸ¨âŸ©á´¾áµ’-monoâœ“

  âºâŸ¨âŸ©áµ€áµ’-monoâœ“ :  (âˆ€ v â†’ Páµ’Ë™ v âŠ¨âœ“ Qáµ’Ë™ v) â†’  âºâŸ¨ vk âŸ©áµ€áµ’ Î¹ Páµ’Ë™ âŠ¨ âºâŸ¨ vk âŸ©áµ€áµ’ Î¹ Qáµ’Ë™
  âºâŸ¨âŸ©áµ€áµ’-monoâœ“ {vk = Ä©â‚€ _} PvâŠ¨âœ“Qv =  âºâŸ¨âŸ©áµ€áµ’-valâ»Â¹ â€º â‡›á´ºáµ’-monoâœ“ (PvâŠ¨âœ“Qv _) â€º
    âºâŸ¨âŸ©áµ€áµ’-val
  âºâŸ¨âŸ©áµ€áµ’-monoâœ“ {vk = Ä©â‚ _} PvâŠ¨âœ“Qv =  âºâŸ¨âŸ©áµ€áµ’-krâ»Â¹ â€º Wpg-mono (âˆ—áµ’-monoË¡
    Î»{ (Â§ big) â†’ Â§ âºâŸ¨âŸ©áµ€áµ’-monoâœ“ PvâŠ¨âœ“Qv big }) â€º âºâŸ¨âŸ©áµ€áµ’-kr

  âºâŸ¨âŸ©áµ€áµ’-mono :  (âˆ€ v â†’ Páµ’Ë™ v âŠ¨ Qáµ’Ë™ v) â†’  âºâŸ¨ vk âŸ©áµ€áµ’ Î¹ Páµ’Ë™ âŠ¨ âºâŸ¨ vk âŸ©áµ€áµ’ Î¹ Qáµ’Ë™
  âºâŸ¨âŸ©áµ€áµ’-mono =  (âŠ¨â‡’âŠ¨âœ“ âˆ˜_) â€º âºâŸ¨âŸ©áµ€áµ’-monoâœ“

  -- âŠ¨âœ“ into âŠ¨ when the right-hand side is áµƒâŸ¨âŸ©áµ’ / âºâŸ¨âŸ©á´¾/áµ€áµ’ / âºâŸ¨âŸ©âˆáµ’

  âŠ¨âœ“â‡’âŠ¨-áµƒâŸ¨âŸ©áµ’ :  Páµ’ âŠ¨âœ“ áµƒâŸ¨ red âŸ©áµ’ Qáµ’Ë™ â†’  Páµ’ âŠ¨ áµƒâŸ¨ red âŸ©áµ’ Qáµ’Ë™
  âŠ¨âœ“â‡’âŠ¨-áµƒâŸ¨âŸ©áµ’ PâŠ¨âœ“âŸ¨redâŸ©Q Pa H =  Pa â–· âŠ¨âœ“â‡’âŠ¨-â‡›Ë¢ (Î» âœ“âˆ™ Pb â†’ PâŠ¨âœ“âŸ¨redâŸ©Q âœ“âˆ™ Pb H)

  âŠ¨âœ“â‡’âŠ¨-âºâŸ¨âŸ©á´¾áµ’ :  Páµ’ âŠ¨âœ“ âºâŸ¨ vk âŸ©á´¾áµ’ Î¹ Qáµ’Ë™ â†’  Páµ’ âŠ¨ âºâŸ¨ vk âŸ©á´¾áµ’ Î¹ Qáµ’Ë™
  âŠ¨âœ“â‡’âŠ¨-âºâŸ¨âŸ©á´¾áµ’ {vk = Ä©â‚€ _} PâŠ¨âœ“âŸ¨vâŸ©Q Pa =  Pa â–·
    âŠ¨âœ“â‡’âŠ¨--âˆ—áµ’ (Î» âœ“âˆ™ Pb â†’ PâŠ¨âœ“âŸ¨vâŸ©Q âœ“âˆ™ Pb â–· âºâŸ¨âŸ©á´¾áµ’-valâ»Â¹) â–· âºâŸ¨âŸ©á´¾áµ’-val
  âŠ¨âœ“â‡’âŠ¨-âºâŸ¨âŸ©á´¾áµ’ {vk = Ä©â‚ _} PâŠ¨âœ“âŸ¨krâŸ©Q Pa =  Pa â–·
    âŠ¨âœ“â‡’âŠ¨--âˆ—áµ’ (Î» âœ“âˆ™ Pb â†’ PâŠ¨âœ“âŸ¨krâŸ©Q âœ“âˆ™ Pb â–· âºâŸ¨âŸ©á´¾áµ’-krâ»Â¹) â–· âºâŸ¨âŸ©á´¾áµ’-kr

  âŠ¨âœ“â‡’âŠ¨-âºâŸ¨âŸ©áµ€áµ’ :  Páµ’ âŠ¨âœ“ âºâŸ¨ vk âŸ©áµ€áµ’ Î¹ Qáµ’Ë™ â†’  Páµ’ âŠ¨ âºâŸ¨ vk âŸ©áµ€áµ’ Î¹ Qáµ’Ë™
  âŠ¨âœ“â‡’âŠ¨-âºâŸ¨âŸ©áµ€áµ’ {vk = Ä©â‚€ _} PâŠ¨âœ“âŸ¨vâŸ©Q Pa =  Pa â–·
    âŠ¨âœ“â‡’âŠ¨--âˆ—áµ’ (Î» âœ“âˆ™ Pb â†’ PâŠ¨âœ“âŸ¨vâŸ©Q âœ“âˆ™ Pb â–· âºâŸ¨âŸ©áµ€áµ’-valâ»Â¹) â–· âºâŸ¨âŸ©áµ€áµ’-val
  âŠ¨âœ“â‡’âŠ¨-âºâŸ¨âŸ©áµ€áµ’ {vk = Ä©â‚ _} PâŠ¨âœ“âŸ¨krâŸ©Q Pa =  Pa â–·
    âŠ¨âœ“â‡’âŠ¨--âˆ—áµ’ (Î» âœ“âˆ™ Pb â†’ PâŠ¨âœ“âŸ¨krâŸ©Q âœ“âˆ™ Pb â–· âºâŸ¨âŸ©áµ€áµ’-krâ»Â¹) â–· âºâŸ¨âŸ©áµ€áµ’-kr

  âŠ¨âœ“â‡’âŠ¨-âºâŸ¨âŸ©âˆáµ’ :  Páµ’ âŠ¨âœ“ âºâŸ¨ vk âŸ©âˆáµ’ Î¹ Î¹' â†’  Páµ’ âŠ¨ âºâŸ¨ vk âŸ©âˆáµ’ Î¹ Î¹'
  âŠ¨âœ“â‡’âŠ¨-âºâŸ¨âŸ©âˆáµ’ {vk = Ä©â‚€ _} PâŠ¨âœ“âŸ¨vâŸ©Q Pa =  Pa â–·
    âŠ¨âœ“â‡’âŠ¨--âˆ—áµ’ (Î» âœ“âˆ™ Pb â†’ PâŠ¨âœ“âŸ¨vâŸ©Q âœ“âˆ™ Pb â–· âºâŸ¨âŸ©âˆáµ’-valâ»Â¹) â–· âºâŸ¨âŸ©âˆáµ’-val
  âŠ¨âœ“â‡’âŠ¨-âºâŸ¨âŸ©âˆáµ’ {vk = Ä©â‚ _} PâŠ¨âœ“âŸ¨krâŸ©Q Pa =  Pa â–·
    âŠ¨âœ“â‡’âŠ¨--âˆ—áµ’ (Î» âœ“âˆ™ Pb â†’ PâŠ¨âœ“âŸ¨krâŸ©Q âœ“âˆ™ Pb â–· âºâŸ¨âŸ©âˆáµ’-krâ»Â¹) â–· âºâŸ¨âŸ©âˆáµ’-kr

  -- Modify the size of âºâŸ¨âŸ©á´¾/áµ€áµ’ / âºâŸ¨âŸ©âˆáµ’ / âŸ¨Â¿ âŸ©áµ€áµ’âŠ¤Ë‚

  âºâŸ¨âŸ©á´¾áµ’-size :  âˆ€{Î¹' : ğ•Š< Î¹} â†’  âºâŸ¨ vk âŸ©á´¾áµ’ Î¹ Páµ’Ë™  âŠ¨  âºâŸ¨ vk âŸ©á´¾áµ’ Î¹' Páµ’Ë™
  âºâŸ¨âŸ©á´¾áµ’-size âŸ¨vkâŸ©P =  âŸ¨vkâŸ©P

  âºâŸ¨âŸ©áµ€áµ’-size :  âˆ€{Î¹' : ğ•Š< Î¹} â†’  âºâŸ¨ vk âŸ©áµ€áµ’ Î¹' Páµ’Ë™  âŠ¨  âºâŸ¨ vk âŸ©áµ€áµ’ Î¹ Páµ’Ë™
  âºâŸ¨âŸ©áµ€áµ’-size âŸ¨vkâŸ©P =  âŸ¨vkâŸ©P

  âºâŸ¨âŸ©âˆáµ’-size :  âˆ€{Î¹â» : ğ•Š< Î¹} {Î¹'â» : ğ•Š< Î¹'} â†’
    âºâŸ¨ vk âŸ©âˆáµ’ Î¹â» Î¹'  âŠ¨  âºâŸ¨ vk âŸ©âˆáµ’ Î¹ Î¹'â»
  âºâŸ¨âŸ©âˆáµ’-size âŸ¨vkâŸ©P =  âŸ¨vkâŸ©P

  âŸ¨Â¿âŸ©áµ€áµ’âŠ¤Ë‚-size :  âˆ€{Î¹' : ğ•Š< Î¹} â†’ âŸ¨Â¿ eË‡ âŸ©áµ€áµ’âŠ¤Ë‚ Î¹'  âŠ¨  âŸ¨Â¿ eË‡ âŸ©áµ€áµ’âŠ¤Ë‚ Î¹
  âŸ¨Â¿âŸ©áµ€áµ’âŠ¤Ë‚-size âŸ¨vkâŸ©P =  âŸ¨vkâŸ©P

  -- Convert âºâŸ¨âŸ©áµ€áµ’ into âºâŸ¨âŸ©á´¾áµ’

  âºâŸ¨âŸ©áµ€áµ’â‡’âºâŸ¨âŸ©á´¾áµ’ :  âºâŸ¨ vk âŸ©áµ€áµ’ Î¹ Páµ’Ë™  âŠ¨  âºâŸ¨ vk âŸ©á´¾áµ’ Î¹' Páµ’Ë™
  âŸ¨Â¿âŸ©áµ€áµ’âŠ¤Ë‚â‡’âŸ¨Â¿âŸ©á´¾áµ’âŠ¤Ë‚ :  âŸ¨Â¿ eË‡ âŸ©áµ€áµ’âŠ¤Ë‚ Î¹  âŠ¨  âŸ¨Â¿ eË‡ âŸ©á´¾áµ’âŠ¤Ë‚ Î¹'

  âºâŸ¨âŸ©áµ€áµ’â‡’âºâŸ¨âŸ©á´¾áµ’ {vk = Ä©â‚€ _} =  âºâŸ¨âŸ©áµ€áµ’-valâ»Â¹ â€º âºâŸ¨âŸ©á´¾áµ’-val
  âºâŸ¨âŸ©áµ€áµ’â‡’âºâŸ¨âŸ©á´¾áµ’ {vk = Ä©â‚ _} =  âºâŸ¨âŸ©áµ€áµ’-krâ»Â¹ â€º Wpg-mono (Î» {_} {eË‡} â†’ âˆ—áµ’-mono
    (Î»{ (Â§ big) â†’ Î»{ .! â†’ âºâŸ¨âŸ©áµ€áµ’â‡’âºâŸ¨âŸ©á´¾áµ’ big }}) $ âŸ¨Â¿âŸ©áµ€áµ’âŠ¤Ë‚â‡’âŸ¨Â¿âŸ©á´¾áµ’âŠ¤Ë‚ {eË‡ = eË‡}) â€º
    âºâŸ¨âŸ©á´¾áµ’-kr

  âŸ¨Â¿âŸ©áµ€áµ’âŠ¤Ë‚â‡’âŸ¨Â¿âŸ©á´¾áµ’âŠ¤Ë‚ {eË‡ = Åˆ} _ =  _
  âŸ¨Â¿âŸ©áµ€áµ’âŠ¤Ë‚â‡’âŸ¨Â¿âŸ©á´¾áµ’âŠ¤Ë‚ {eË‡ = Å¡ _} (Â§ big) .! =
    big â–· âºâŸ¨âŸ©áµ€áµ’âŠ¤â‡’âºâŸ¨âŸ©áµ€áµ’ â–· âºâŸ¨âŸ©áµ€áµ’â‡’âºâŸ¨âŸ©á´¾áµ’ â–· âºâŸ¨âŸ©á´¾áµ’â‡’âºâŸ¨âŸ©á´¾áµ’âŠ¤

  -- Convert âºâŸ¨âŸ©âˆáµ’ into âºâŸ¨âŸ©á´¾áµ’

  âºâŸ¨âŸ©âˆáµ’â‡’âºâŸ¨âŸ©á´¾áµ’ :  âºâŸ¨ vk âŸ©âˆáµ’ Î¹ Î¹'  âŠ¨  âºâŸ¨ vk âŸ©á´¾áµ’ Î¹' Páµ’Ë™
  âºâŸ¨âŸ©âˆáµ’â‡’âºâŸ¨âŸ©á´¾áµ’ {vk = Ä©â‚€ _} =  âºâŸ¨âŸ©âˆáµ’-valâ»Â¹ â€º â‡›á´ºáµ’-mono absurd â€º âºâŸ¨âŸ©á´¾áµ’-val
  âºâŸ¨âŸ©âˆáµ’â‡’âºâŸ¨âŸ©á´¾áµ’ {vk = Ä©â‚ _} =  âºâŸ¨âŸ©âˆáµ’-krâ»Â¹ â€º Wpg-mono (Î» {_} {eË‡} â†’ Î»{
    {ff} â†’ âˆ—áµ’-mono (Î»{ (Â§ big) â†’ Î»{ .! â†’ âºâŸ¨âŸ©âˆáµ’â‡’âºâŸ¨âŸ©á´¾áµ’ big }}) $
      âŸ¨Â¿âŸ©áµ€áµ’âŠ¤Ë‚â‡’âŸ¨Â¿âŸ©á´¾áµ’âŠ¤Ë‚ {eË‡ = eË‡};
    {tt} â†’ âˆ—áµ’-mono (Î» big â†’ Î»{ .! â†’ âºâŸ¨âŸ©âˆáµ’â‡’âºâŸ¨âŸ©á´¾áµ’ $ big .! }) $
      âŸ¨Â¿âŸ©áµ€áµ’âŠ¤Ë‚â‡’âŸ¨Â¿âŸ©á´¾áµ’âŠ¤Ë‚ {eË‡ = eË‡} }) â€º âºâŸ¨âŸ©á´¾áµ’-kr

  -- Wpg absorbs â‡›á´ºáµ’ outside

  â‡›á´ºáµ’-Wpg :  â‡›á´ºáµ’ Wpg kr Páµ’Ë™Â³  âŠ¨  Wpg kr Páµ’Ë™Â³
  â‡›á´ºáµ’-Wpg =  -âˆ—áµ’-monoÊ³ Î» big H â†’ big H â–·
    â‡›Ë¢-monoâœ“ (Î» âœ“âˆ™ â†’ -âˆ—áµ’-applyË¡ âˆ€áµ’â‡›Ë¢-Mono âœ“âˆ™ â€º _$ H) â–· â‡›Ë¢-join

  -- áµƒâŸ¨âŸ©áµ’ and âºâŸ¨âŸ©á´¾/áµ€/âˆáµ’ absorb â‡›á´ºáµ’/â‡›áµ’ outside

  â‡›áµ’-áµƒâŸ¨âŸ©áµ’ :  â‡›áµ’ áµƒâŸ¨ red âŸ©áµ’ Páµ’Ë™  âŠ¨  áµƒâŸ¨ red âŸ©áµ’ Páµ’Ë™
  â‡›áµ’-áµƒâŸ¨âŸ©áµ’ big H =  big H â–· â‡›Ë¢-mono (_$ H) â–· â‡›Ë¢-join

  â‡›á´ºáµ’-âºâŸ¨âŸ©á´¾áµ’ :  â‡›á´ºáµ’ âºâŸ¨ vk âŸ©á´¾áµ’ Î¹ Páµ’Ë™  âŠ¨  âºâŸ¨ vk âŸ©á´¾áµ’ Î¹ Páµ’Ë™
  â‡›á´ºáµ’-âºâŸ¨âŸ©á´¾áµ’ {vk = Ä©â‚€ _} =  â‡›á´ºáµ’-mono âºâŸ¨âŸ©á´¾áµ’-valâ»Â¹ â€º â‡›á´ºáµ’-join â€º âºâŸ¨âŸ©á´¾áµ’-val
  â‡›á´ºáµ’-âºâŸ¨âŸ©á´¾áµ’ {vk = Ä©â‚ _} =  â‡›á´ºáµ’-mono âºâŸ¨âŸ©á´¾áµ’-krâ»Â¹ â€º â‡›á´ºáµ’-Wpg â€º âºâŸ¨âŸ©á´¾áµ’-kr

  â‡›áµ’-âºâŸ¨âŸ©á´¾áµ’ :  â‡›áµ’ âºâŸ¨ vk âŸ©á´¾áµ’ Î¹ Páµ’Ë™  âŠ¨  âºâŸ¨ vk âŸ©á´¾áµ’ Î¹ Páµ’Ë™
  â‡›áµ’-âºâŸ¨âŸ©á´¾áµ’ =  â‡›áµ’â‡’â‡›á´ºáµ’ â€º â‡›á´ºáµ’-âºâŸ¨âŸ©á´¾áµ’

  â‡›á´ºáµ’-âºâŸ¨âŸ©áµ€áµ’ :  â‡›á´ºáµ’ âºâŸ¨ vk âŸ©áµ€áµ’ Î¹ Páµ’Ë™  âŠ¨  âºâŸ¨ vk âŸ©áµ€áµ’ Î¹ Páµ’Ë™
  â‡›á´ºáµ’-âºâŸ¨âŸ©áµ€áµ’ {vk = Ä©â‚€ _} =  â‡›á´ºáµ’-mono âºâŸ¨âŸ©áµ€áµ’-valâ»Â¹ â€º â‡›á´ºáµ’-join â€º âºâŸ¨âŸ©áµ€áµ’-val
  â‡›á´ºáµ’-âºâŸ¨âŸ©áµ€áµ’ {vk = Ä©â‚ _} =  â‡›á´ºáµ’-mono âºâŸ¨âŸ©áµ€áµ’-krâ»Â¹ â€º â‡›á´ºáµ’-Wpg â€º âºâŸ¨âŸ©áµ€áµ’-kr

  â‡›áµ’-âºâŸ¨âŸ©áµ€áµ’ :  â‡›áµ’ âºâŸ¨ vk âŸ©áµ€áµ’ Î¹ Páµ’Ë™  âŠ¨  âºâŸ¨ vk âŸ©áµ€áµ’ Î¹ Páµ’Ë™
  â‡›áµ’-âºâŸ¨âŸ©áµ€áµ’ =  â‡›áµ’â‡’â‡›á´ºáµ’ â€º â‡›á´ºáµ’-âºâŸ¨âŸ©áµ€áµ’

  â‡›á´ºáµ’-âºâŸ¨âŸ©âˆáµ’ :  â‡›á´ºáµ’ âºâŸ¨ vk âŸ©âˆáµ’ Î¹ Î¹'  âŠ¨  âºâŸ¨ vk âŸ©âˆáµ’ Î¹ Î¹'
  â‡›á´ºáµ’-âºâŸ¨âŸ©âˆáµ’ {vk = Ä©â‚€ _} =  â‡›á´ºáµ’-mono âºâŸ¨âŸ©âˆáµ’-valâ»Â¹ â€º â‡›á´ºáµ’-join â€º âºâŸ¨âŸ©âˆáµ’-val
  â‡›á´ºáµ’-âºâŸ¨âŸ©âˆáµ’ {vk = Ä©â‚ _} =  â‡›á´ºáµ’-mono âºâŸ¨âŸ©âˆáµ’-krâ»Â¹ â€º â‡›á´ºáµ’-Wpg â€º âºâŸ¨âŸ©âˆáµ’-kr

  â‡›áµ’-âºâŸ¨âŸ©âˆáµ’ :  â‡›áµ’ âºâŸ¨ vk âŸ©âˆáµ’ Î¹ Î¹'  âŠ¨  âºâŸ¨ vk âŸ©âˆáµ’ Î¹ Î¹'
  â‡›áµ’-âºâŸ¨âŸ©âˆáµ’ =  â‡›áµ’â‡’â‡›á´ºáµ’ â€º â‡›á´ºáµ’-âºâŸ¨âŸ©âˆáµ’

  -- áµƒâŸ¨âŸ©áµ’ absorbs â‡›áµ’ inside

  áµƒâŸ¨âŸ©áµ’-â‡›áµ’ :  áµƒâŸ¨ red âŸ©áµ’ (Î» v â†’ â‡›áµ’ Páµ’Ë™ v)  âŠ¨  áµƒâŸ¨ red âŸ©áµ’ Páµ’Ë™
  áµƒâŸ¨âŸ©áµ’-â‡›áµ’ big H =  big H â–· â‡›Ë¢-mono Î» (redHâ‡’ , big) â†’ redHâ‡’ , Î» e eË‡ H' eeË‡H'â‡ â†’
    big e eË‡ H' eeË‡H'â‡ â–· Î» (-, â‰¡vÅˆ , big) â†’ -, â‰¡vÅˆ ,
    big â–· â‡›Ë¢-mono (_$ H') â–· â‡›Ë¢-join

  -- âºâŸ¨âŸ©á´¾/áµ€áµ’ absorbs â‡›á´ºáµ’/â‡›áµ’ inside

  âºâŸ¨âŸ©á´¾áµ’-â‡›á´ºáµ’ :  âºâŸ¨ vk âŸ©á´¾áµ’ Î¹ (Î» v â†’ â‡›á´ºáµ’ Páµ’Ë™ v)  âŠ¨  âºâŸ¨ vk âŸ©á´¾áµ’ Î¹ Páµ’Ë™
  âºâŸ¨âŸ©á´¾áµ’-â‡›á´ºáµ’ {vk = Ä©â‚€ _} =  âºâŸ¨âŸ©á´¾áµ’-valâ»Â¹ â€º â‡›á´ºáµ’-join â€º âºâŸ¨âŸ©á´¾áµ’-val
  âºâŸ¨âŸ©á´¾áµ’-â‡›á´ºáµ’ {vk = Ä©â‚ _} =  âºâŸ¨âŸ©á´¾áµ’-krâ»Â¹ â€º
    Wpg-mono (âˆ—áµ’-monoË¡ Î» big â†’ Î»{ .! â†’ âºâŸ¨âŸ©á´¾áµ’-â‡›á´ºáµ’ $ big .! }) â€º âºâŸ¨âŸ©á´¾áµ’-kr

  âºâŸ¨âŸ©á´¾áµ’-â‡›áµ’ :  âºâŸ¨ vk âŸ©á´¾áµ’ Î¹ (Î» v â†’ â‡›áµ’ Páµ’Ë™ v)  âŠ¨  âºâŸ¨ vk âŸ©á´¾áµ’ Î¹ Páµ’Ë™
  âºâŸ¨âŸ©á´¾áµ’-â‡›áµ’ =  âºâŸ¨âŸ©á´¾áµ’-mono (Î» _ â†’ â‡›áµ’â‡’â‡›á´ºáµ’) â€º âºâŸ¨âŸ©á´¾áµ’-â‡›á´ºáµ’

  âºâŸ¨âŸ©áµ€áµ’-â‡›á´ºáµ’ :  âºâŸ¨ vk âŸ©áµ€áµ’ Î¹ (Î» v â†’ â‡›á´ºáµ’ Páµ’Ë™ v)  âŠ¨  âºâŸ¨ vk âŸ©áµ€áµ’ Î¹ Páµ’Ë™
  âºâŸ¨âŸ©áµ€áµ’-â‡›á´ºáµ’ {vk = Ä©â‚€ _} =  âºâŸ¨âŸ©áµ€áµ’-valâ»Â¹ â€º â‡›á´ºáµ’-join â€º âºâŸ¨âŸ©áµ€áµ’-val
  âºâŸ¨âŸ©áµ€áµ’-â‡›á´ºáµ’ {vk = Ä©â‚ _} =  âºâŸ¨âŸ©áµ€áµ’-krâ»Â¹ â€º
    Wpg-mono (âˆ—áµ’-monoË¡ Î»{ (Â§ big) â†’ Â§ âºâŸ¨âŸ©áµ€áµ’-â‡›á´ºáµ’ big }) â€º âºâŸ¨âŸ©áµ€áµ’-kr

  âºâŸ¨âŸ©áµ€áµ’-â‡›áµ’ :  âºâŸ¨ vk âŸ©áµ€áµ’ Î¹ (Î» v â†’ â‡›áµ’ Páµ’Ë™ v)  âŠ¨  âºâŸ¨ vk âŸ©áµ€áµ’ Î¹ Páµ’Ë™
  âºâŸ¨âŸ©áµ€áµ’-â‡›áµ’ =  âºâŸ¨âŸ©áµ€áµ’-mono (Î» _ â†’ â‡›áµ’â‡’â‡›á´ºáµ’) â€º âºâŸ¨âŸ©áµ€áµ’-â‡›á´ºáµ’

  -- Let Wpg eat a proposition

  Wpg-eatË¡ :  Qáµ’ âˆ—áµ’ Wpg kr Páµ’Ë™Â³  âŠ¨  Wpg kr (Î» e eË‡ b â†’ Qáµ’ âˆ—áµ’ Páµ’Ë™Â³ e eË‡ b)
  Wpg-eatË¡ =  -âˆ—áµ’-eatË¡ âˆ€áµ’â‡›Ë¢-Mono â€º -âˆ—áµ’-monoÊ³ Î» big H â†’ big â–· âˆ—áµ’-monoÊ³ (_$ H) â–·
    â‡›Ë¢-eatË¡ â–· â‡›Ë¢-mono (âˆ—áµ’âˆƒáµ’-out â€º Î» (krHâ‡’ , big) â†’ krHâ‡’ , Î» e eË‡ H' b eeË‡H'â‡b â†’
    big â–· âˆ—áµ’-monoÊ³ (Î» big â†’ big e eË‡ H' b eeË‡H'â‡b) â–· â‡›Ë¢-eatË¡ â–· â‡›Ë¢-mono ?âˆ—áµ’-comm)

  -- Let áµƒâŸ¨âŸ©áµ’ and âºâŸ¨âŸ©á´¾/áµ€áµ’ eat a proposition

  áµƒâŸ¨âŸ©áµ’-eatË¡ :  Qáµ’ âˆ—áµ’ (áµƒâŸ¨ red âŸ©áµ’ Páµ’Ë™)  âŠ¨  áµƒâŸ¨ red âŸ©áµ’ Î» v â†’ Qáµ’ âˆ—áµ’ Páµ’Ë™ v
  áµƒâŸ¨âŸ©áµ’-eatË¡ big H =  big â–· âˆ—áµ’-monoÊ³ (_$ H) â–· â‡›Ë¢-eatË¡ â–· â‡›Ë¢-mono (âˆ—áµ’âˆƒáµ’-out â€º
    Î» (redHâ‡’ , big) â†’ redHâ‡’ , Î» e eË‡ H' eeË‡H'â‡ â†’ big â–·
    âˆ—áµ’-monoÊ³ (Î» big â†’ big e eË‡ H' eeË‡H'â‡) â–· âˆ—áµ’âˆƒáµ’-out â–· Î» (-, big) â†’ -,
    big â–· âˆ—áµ’âˆƒáµ’-out â–· Î» (â‰¡vÅˆ , big) â†’ â‰¡vÅˆ , big â–· â‡›Ë¢-eatË¡)

  âºâŸ¨âŸ©á´¾áµ’-eatË¡ :  Qáµ’ âˆ—áµ’ (âºâŸ¨ vk âŸ©á´¾áµ’ Î¹ Páµ’Ë™)  âŠ¨  âºâŸ¨ vk âŸ©á´¾áµ’ Î¹ Î» v â†’ Qáµ’ âˆ—áµ’ Páµ’Ë™ v
  âºâŸ¨âŸ©á´¾áµ’-eatË¡ {vk = Ä©â‚€ _} =  âˆ—áµ’-monoÊ³ âºâŸ¨âŸ©á´¾áµ’-valâ»Â¹ â€º â‡›á´ºáµ’-eatË¡ â€º âºâŸ¨âŸ©á´¾áµ’-val
  âºâŸ¨âŸ©á´¾áµ’-eatË¡ {vk = Ä©â‚ _} =  âˆ—áµ’-monoÊ³ âºâŸ¨âŸ©á´¾áµ’-krâ»Â¹ â€º Wpg-eatË¡ â€º
    Wpg-mono (âˆ—áµ’-assocË¡ â€º âˆ—áµ’-monoË¡ $ âˆ—áµ’Thunkáµ’-out â€º
    Î» big â†’ Î»{ .! â†’ âºâŸ¨âŸ©á´¾áµ’-eatË¡ $ big .! }) â€º âºâŸ¨âŸ©á´¾áµ’-kr

  âºâŸ¨âŸ©áµ€áµ’-eatË¡ :  Qáµ’ âˆ—áµ’ (âºâŸ¨ vk âŸ©áµ€áµ’ Î¹ Páµ’Ë™)  âŠ¨  âºâŸ¨ vk âŸ©áµ€áµ’ Î¹ Î» v â†’ Qáµ’ âˆ—áµ’ Páµ’Ë™ v
  âºâŸ¨âŸ©áµ€áµ’-eatË¡ {vk = Ä©â‚€ _} =  âˆ—áµ’-monoÊ³ âºâŸ¨âŸ©áµ€áµ’-valâ»Â¹ â€º â‡›á´ºáµ’-eatË¡ â€º âºâŸ¨âŸ©áµ€áµ’-val
  âºâŸ¨âŸ©áµ€áµ’-eatË¡ {vk = Ä©â‚ _} =  âˆ—áµ’-monoÊ³ âºâŸ¨âŸ©áµ€áµ’-krâ»Â¹ â€º Wpg-eatË¡ â€º
    Wpg-mono (âˆ—áµ’-assocË¡ â€º âˆ—áµ’-monoË¡ $ âˆ—áµ’Shrunkáµ’-out â€º
    Î»{ (Â§ big) â†’ Â§ âºâŸ¨âŸ©áµ€áµ’-eatË¡ big }) â€º âºâŸ¨âŸ©áµ€áµ’-kr

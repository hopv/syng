--------------------------------------------------------------------------------
-- Proof rules on the indirection modality and the precursors
--------------------------------------------------------------------------------

{-# OPTIONS --without-K --sized-types #-}

module Symp.Logic.Ind where

open import Base.Func using (_$_; _âˆ˜_; id; const)
open import Base.Size using (ğ•Š; Thunk; Â¡_; !; _$áµ€Ê°_)
open import Base.Nat using (â„•)
open import Symp.Lang.Expr using (Type; Exprâˆ)
open import Symp.Lang.Ktxred using (Redex)
open import Symp.Logic.Prop using (WpKind; SPropâˆ; SPropË‚âˆ; Â¡á´¾_; âˆ€-syntax; _âˆ—_;
  _-âˆ—_; â–¡_; â—‹_; _â†ª[_]â‡›_; _â†ª[_]áµƒâŸ¨_âŸ©_; _â†ªâŸ¨_âŸ©[_]_; _â†ªâŸ¨_âŸ©á´¾_; _â†ªâŸ¨_âŸ©áµ€[_]_; _â†ª[_]âŸ¨_âŸ©âˆ;
  Basic)
open import Symp.Logic.Core using (_âŠ¢[_]_; _âŠ¢[<_]_; Pers; â‡’<; âŠ¢-refl; _Â»_;
  âˆ—-comm; âˆ—-elimÊ³; âŠ¤âˆ—-intro; -âˆ—-elimË¡; -âˆ—-const)
open import Symp.Logic.Fupd using ([_]â‡›_; _âŠ¢[_][_]â‡›_; _âŠ¢[<_][_]â‡›_; _âŠ¢[<_][_]â‡›á´º_;
  â‡’â‡›; _áµ˜Â»_; _Â»áµ˜á´º_; â‡›â‡’â‡›á´º)

-- Import and re-export
open import Symp.Logic.Judg public using (â—‹-mono; â—‹-eatË¡; â—‹-new; â–¡â—‹-new-rec;
  â—‹-use; â†ªâ‡›-â‰¤; â†ªâ‡›-eatË¡â»Ë¡áµ˜; â†ªâ‡›-monoÊ³áµ˜; â†ªâ‡›-eatË¡â»Ê³; â†ªâ‡›-frameÊ³; â—‹â‡’â†ªâ‡›; â†ªâ‡›-use;
  â†ªáµƒâŸ¨âŸ©-â‰¤; â†ªáµƒâŸ¨âŸ©-eatË¡â»Ë¡áµ˜; â†ªáµƒâŸ¨âŸ©-monoÊ³áµ˜; â†ªáµƒâŸ¨âŸ©-eatË¡â»Ê³; â†ªáµƒâŸ¨âŸ©-frameÊ³; â—‹â‡’â†ªáµƒâŸ¨âŸ©; â†ªáµƒâŸ¨âŸ©-use;
  â†ªâŸ¨âŸ©áµ€â‡’â†ªâŸ¨âŸ©á´¾; â†ªâŸ¨âŸ©áµ€-â‰¤; â†ªâŸ¨âŸ©-eatË¡â»Ë¡áµ˜á´º; â†ªâŸ¨âŸ©-monoÊ³áµ˜á´º; â†ªâŸ¨âŸ©-eatË¡â»Ê³; â†ªâŸ¨âŸ©-frameÊ³; â—‹â‡’â†ªâŸ¨âŸ©;
  â†ªâŸ¨âŸ©á´¾-use; â†ªâŸ¨âŸ©áµ€-use; â†ªâŸ¨âŸ©âˆ-â‰¤; â†ªâŸ¨âŸ©âˆ-eatË¡â»áµ˜á´º; â—‹â‡’â†ªâŸ¨âŸ©âˆ; â†ªâŸ¨âŸ©âˆ-use)

private variable
  Î¹ :  ğ•Š
  i j :  â„•
  T :  Type
  P Q R :  SPropâˆ
  PË‚ P'Ë‚ QË‚ Q'Ë‚ RË‚ :  SPropË‚âˆ
  X Y :  Setâ‚€
  x :  X
  QË™ :  X â†’ SPropâˆ
  PË‚Ë™ QË‚Ë™ Q'Ë‚Ë™ :  X â†’ SPropË‚âˆ
  QË‚Ë™Ë™ :  X â†’ Y â†’ SPropË‚âˆ
  Îº :  WpKind
  red :  Redex T
  e :  Exprâˆ T

abstract

  ------------------------------------------------------------------------------
  -- On â—‹

  -->  â—‹-mono :  PË‚ .! âŠ¢[< Î¹ ] QË‚ .! â†’  â—‹ PË‚ âŠ¢[ Î¹ ] â—‹ QË‚

  -->  â—‹-use :  â—‹ PË‚ âŠ¢[ Î¹ ][ i ]â‡› PË‚ .!

  -- Let â—‹ eat a basic proposition

  -->  â—‹-eatË¡ :  {{Basic Q}} â†’  Q âˆ— â—‹ PË‚ âŠ¢[ Î¹ ] â—‹ Â¡á´¾ (Q âˆ— PË‚ .!)

  â—‹-eatÊ³ :  {{Basic Q}} â†’  â—‹ PË‚ âˆ— Q âŠ¢[ Î¹ ] â—‹ Â¡á´¾ (PË‚ .! âˆ— Q)
  â—‹-eatÊ³ =  âˆ—-comm Â» â—‹-eatË¡ Â» â—‹-mono $ â‡’< âˆ—-comm

  -- Get â—‹

  -->  â—‹-new :  PË‚ .! âŠ¢[ Î¹ ][ i ]â‡› â—‹ PË‚

  -->  â–¡â—‹-new-rec :  â–¡ â—‹ PË‚ -âˆ— â–¡ PË‚ .! âŠ¢[ Î¹ ][ i ]â‡› â–¡ â—‹ PË‚

  â–¡â—‹-new :  â–¡ PË‚ .! âŠ¢[ Î¹ ][ i ]â‡› â–¡ â—‹ PË‚
  â–¡â—‹-new =  -âˆ—-const Â» â–¡â—‹-new-rec

  ------------------------------------------------------------------------------
  -- On â†ªâ‡›

  -->  â—‹â‡’â†ªâ‡› :  PË‚ .!  âˆ—  RË‚ .!  âŠ¢[< Î¹ ][ i ]â‡›  QË‚ .!  â†’
  -->          â—‹ RË‚  âŠ¢[ Î¹ ]  PË‚ â†ª[ i ]â‡› QË‚

  -->  â†ªâ‡›-use :  PË‚ .!  âˆ—  (PË‚ â†ª[ i ]â‡› QË‚)  âŠ¢[ Î¹ ][ á¹¡ i ]â‡›  QË‚ .!

  -- Modify â‡› proof

  -->  â†ªâ‡›-â‰¤ :  i â‰¤ j  â†’   PË‚ â†ª[ i ]â‡› QË‚  âŠ¢[ Î¹ ]  PË‚ â†ª[ j ]â‡› QË‚

  -->  â†ªâ‡›-eatË¡â»Ë¡áµ˜ :  {{Basic R}}  â†’   R  âˆ—  P'Ë‚ .!  âŠ¢[< Î¹ ][ i ]â‡›  PË‚ .! â†’
  -->                R  âˆ—  (PË‚ â†ª[ i ]â‡› QË‚)  âŠ¢[ Î¹ ]  P'Ë‚ â†ª[ i ]â‡› QË‚

  â†ªâ‡›-monoË¡áµ˜ :  P'Ë‚ .! âŠ¢[< Î¹ ][ i ]â‡› PË‚ .! â†’
               PË‚ â†ª[ i ]â‡› QË‚  âŠ¢[ Î¹ ]  P'Ë‚ â†ª[ i ]â‡› QË‚
  â†ªâ‡›-monoË¡áµ˜ P'âŠ¢â‡›P =  âŠ¤âˆ—-intro Â» â†ªâ‡›-eatË¡â»Ë¡áµ˜ $ (âˆ—-elimÊ³ Â»_) $áµ€Ê° P'âŠ¢â‡›P

  â†ªâ‡›-eatË¡â»Ë¡ :  {{Basic R}}  â†’
    R âˆ— (PË‚ â†ª[ i ]â‡› QË‚)  âŠ¢[ Î¹ ]  Â¡á´¾ (R -âˆ— PË‚ .!) â†ª[ i ]â‡› QË‚
  â†ªâ‡›-eatË¡â»Ë¡ =  â†ªâ‡›-eatË¡â»Ë¡áµ˜ $ â‡’< $ â‡’â‡› $ -âˆ—-elimË¡ âŠ¢-refl

  â†ªâ‡›-monoË¡ :  P'Ë‚ .! âŠ¢[< Î¹ ] PË‚ .! â†’
              PË‚ â†ª[ i ]â‡› QË‚  âŠ¢[ Î¹ ]  P'Ë‚ â†ª[ i ]â‡› QË‚
  â†ªâ‡›-monoË¡ P'âŠ¢P =  â†ªâ‡›-monoË¡áµ˜ $ â‡’â‡› $áµ€Ê° P'âŠ¢P

  -->  â†ªâ‡›-monoÊ³áµ˜ :  QË‚ .!  âŠ¢[< Î¹ ][ i ]â‡›  Q'Ë‚ .! â†’
  -->               PË‚ â†ª[ i ]â‡› QË‚  âŠ¢[ Î¹ ]  PË‚ â†ª[ i ]â‡› Q'Ë‚

  â†ªâ‡›-monoÊ³ :  QË‚ .!  âŠ¢[< Î¹ ]  Q'Ë‚ .!  â†’
              PË‚ â†ª[ i ]â‡› QË‚  âŠ¢[ Î¹ ]  PË‚ â†ª[ i ]â‡› Q'Ë‚
  â†ªâ‡›-monoÊ³ QâŠ¢Q' =  â†ªâ‡›-monoÊ³áµ˜ $ â‡’â‡› $áµ€Ê° QâŠ¢Q'

  -->  â†ªâ‡›-eatË¡â»Ê³ :  {{Basic R}}  â†’
  -->    R  âˆ—  (PË‚ â†ª[ i ]â‡› QË‚)  âŠ¢[ Î¹ ]  PË‚ â†ª[ i ]â‡› Â¡á´¾ (R âˆ— QË‚ .!)

  -->  â†ªâ‡›-frameÊ³ :  PË‚ â†ª[ i ]â‡› QË‚  âŠ¢[ Î¹ ]
  -->                 Â¡á´¾ (R âˆ— PË‚ .!) â†ª[ i ]â‡› Â¡á´¾ (R âˆ— QË‚ .!)

  â†ªâ‡›-frameË¡ :  PË‚ â†ª[ i ]â‡› QË‚  âŠ¢[ Î¹ ]  Â¡á´¾ (PË‚ .! âˆ— R) â†ª[ i ]â‡› Â¡á´¾ (QË‚ .! âˆ— R)
  â†ªâ‡›-frameË¡ =  â†ªâ‡›-frameÊ³ Â» â†ªâ‡›-monoË¡ (â‡’< âˆ—-comm) Â» â†ªâ‡›-monoÊ³ $ â‡’< âˆ—-comm

  ------------------------------------------------------------------------------
  -- On â†ªáµƒâŸ¨ âŸ©

  -->  â—‹â‡’â†ªáµƒâŸ¨âŸ© :  PË‚ .!  âˆ—  RË‚ .!  âŠ¢[< Î¹ ][ i ]áµƒâŸ¨ red âŸ© (Î» v â†’  QË‚Ë™ v .!)  â†’
  -->            â—‹ RË‚  âŠ¢[ Î¹ ]  PË‚ â†ª[ i ]áµƒâŸ¨ red âŸ© QË‚Ë™

  -->  â†ªáµƒâŸ¨âŸ©-use :  PË‚ .!  âˆ—  (PË‚ â†ª[ i ]áµƒâŸ¨ red âŸ© QË‚Ë™)
  -->                âŠ¢[ Î¹ ][ á¹¡ i ]áµƒâŸ¨ red âŸ© Î» v â†’  QË‚Ë™ v .!

  -- Modify âŸ¨ âŸ©áµ€ proof

  -->  â†ªáµƒâŸ¨âŸ©-â‰¤ :  i â‰¤ j  â†’   PË‚ â†ª[ i ]áµƒâŸ¨ red âŸ© QË‚Ë™  âŠ¢[ Î¹ ]  PË‚ â†ª[ j ]áµƒâŸ¨ red âŸ© QË‚Ë™

  -->  â†ªáµƒâŸ¨âŸ©-eatË¡â»Ë¡áµ˜ :  {{Basic R}}  â†’   R  âˆ—  P'Ë‚ .!  âŠ¢[< Î¹ ][ j ]â‡›  PË‚ .!  â†’
  -->    R âˆ— (PË‚ â†ª[ i ]áµƒâŸ¨ red âŸ© QË‚Ë™)  âŠ¢[ Î¹ ]  P'Ë‚ â†ª[ i ]áµƒâŸ¨ red âŸ© QË‚Ë™

  â†ªáµƒâŸ¨âŸ©-monoË¡áµ˜ :  P'Ë‚ .! âŠ¢[< Î¹ ][ i ]â‡› PË‚ .! â†’
                 PË‚ â†ª[ j ]áµƒâŸ¨ red âŸ© QË‚Ë™  âŠ¢[ Î¹ ]  P'Ë‚ â†ª[ j ]áµƒâŸ¨ red âŸ© QË‚Ë™
  â†ªáµƒâŸ¨âŸ©-monoË¡áµ˜ P'âŠ¢â‡›P =  âŠ¤âˆ—-intro Â» â†ªáµƒâŸ¨âŸ©-eatË¡â»Ë¡áµ˜ $ (âˆ—-elimÊ³ Â»_) $áµ€Ê° P'âŠ¢â‡›P

  â†ªáµƒâŸ¨âŸ©-eatË¡â»Ë¡ :  {{Basic R}}  â†’
    R âˆ— (PË‚ â†ª[ i ]áµƒâŸ¨ red âŸ© QË‚Ë™)  âŠ¢[ Î¹ ]  Â¡á´¾ (R -âˆ— PË‚ .!) â†ª[ i ]áµƒâŸ¨ red âŸ© QË‚Ë™
  â†ªáµƒâŸ¨âŸ©-eatË¡â»Ë¡ =  â†ªáµƒâŸ¨âŸ©-eatË¡â»Ë¡áµ˜ {i = 0} $ â‡’< $ â‡’â‡› $ -âˆ—-elimË¡ âŠ¢-refl

  â†ªáµƒâŸ¨âŸ©-monoË¡ :  P'Ë‚ .! âŠ¢[< Î¹ ] PË‚ .! â†’
                PË‚ â†ª[ i ]áµƒâŸ¨ red âŸ© QË‚Ë™  âŠ¢[ Î¹ ]  P'Ë‚ â†ª[ i ]áµƒâŸ¨ red âŸ© QË‚Ë™
  â†ªáµƒâŸ¨âŸ©-monoË¡ P'âŠ¢P =  â†ªáµƒâŸ¨âŸ©-monoË¡áµ˜ {i = 0} $ â‡’â‡› $áµ€Ê° P'âŠ¢P

  -->  â†ªáµƒâŸ¨âŸ©-monoÊ³áµ˜ :  (âˆ€ v â†’  QË‚Ë™ v .!  âŠ¢[< Î¹ ][ i ]â‡›  Q'Ë‚Ë™ v .!)  â†’
  -->                 PË‚ â†ª[ j ]áµƒâŸ¨ red âŸ© QË‚Ë™  âŠ¢[ Î¹ ]  PË‚ â†ª[ j ]áµƒâŸ¨ red âŸ© Q'Ë‚Ë™

  â†ªáµƒâŸ¨âŸ©-monoÊ³ :  (âˆ€ v â†’  QË‚Ë™ v .!  âŠ¢[< Î¹ ]  Q'Ë‚Ë™ v .!)  â†’
                PË‚ â†ª[ i ]áµƒâŸ¨ red âŸ© QË‚Ë™  âŠ¢[ Î¹ ]  PË‚ â†ª[ i ]áµƒâŸ¨ red âŸ© Q'Ë‚Ë™
  â†ªáµƒâŸ¨âŸ©-monoÊ³ QvâŠ¢Q'v =  â†ªáµƒâŸ¨âŸ©-monoÊ³áµ˜ {i = 0} Î» v â†’ â‡’â‡› $áµ€Ê° QvâŠ¢Q'v v

  -->  â†ªáµƒâŸ¨âŸ©-eatË¡â»Ê³ :  {{Basic R}}  â†’
  -->    R  âˆ—  (PË‚ â†ª[ i ]áµƒâŸ¨ red âŸ© QË‚Ë™)  âŠ¢[ Î¹ ]
  -->      PË‚ â†ª[ i ]áµƒâŸ¨ red âŸ© Î» v â†’ Â¡á´¾ (R âˆ— QË‚Ë™ v .!)

  -->  â†ªáµƒâŸ¨âŸ©-frameÊ³ :  PË‚ â†ª[ i ]áµƒâŸ¨ red âŸ© QË‚Ë™  âŠ¢[ Î¹ ]
  -->                  Â¡á´¾ (R âˆ— PË‚ .!) â†ª[ i ]áµƒâŸ¨ red âŸ© Î» v â†’ Â¡á´¾ (R âˆ— QË‚Ë™ v .!)

  â†ªáµƒâŸ¨âŸ©-frameË¡ :  PË‚ â†ª[ i ]áµƒâŸ¨ red âŸ© QË‚Ë™  âŠ¢[ Î¹ ]
                   Â¡á´¾ (PË‚ .! âˆ— R) â†ª[ i ]áµƒâŸ¨ red âŸ© Î» v â†’ Â¡á´¾ (QË‚Ë™ v .! âˆ— R)
  â†ªáµƒâŸ¨âŸ©-frameË¡ =  â†ªáµƒâŸ¨âŸ©-frameÊ³ Â»
    â†ªáµƒâŸ¨âŸ©-monoË¡ (â‡’< âˆ—-comm) Â» â†ªáµƒâŸ¨âŸ©-monoÊ³ Î» _ â†’ â‡’< âˆ—-comm

  ------------------------------------------------------------------------------
  -- On â†ªâŸ¨ âŸ©

  -->  â†ªâŸ¨âŸ©áµ€â‡’â†ªâŸ¨âŸ©á´¾ :  PË‚ â†ªâŸ¨ e âŸ©áµ€[ i ] QË‚Ë™  âŠ¢[ Î¹ ]  PË‚ â†ªâŸ¨ e âŸ©á´¾ QË‚Ë™

  -->  â—‹â‡’â†ªâŸ¨âŸ© :  PË‚ .!  âˆ—  RË‚ .!  âŠ¢[< Î¹ ]âŸ¨ e âŸ©[ Îº ] (Î» v â†’  QË‚Ë™ v .!)  â†’
  -->           â—‹ RË‚  âŠ¢[ Î¹ ]  PË‚ â†ªâŸ¨ e âŸ©[ Îº ] QË‚Ë™

  -->  â†ªâŸ¨âŸ©á´¾-use :  e â‡’á´¾ e'  â†’
  -->    PË‚ .!  âˆ—  (PË‚ â†ªâŸ¨ e' âŸ©á´¾ QË‚Ë™)  âŠ¢[ Î¹ ]âŸ¨ e âŸ©á´¾ Î» v â†’  QË‚Ë™ v .!

  -->  â†ªâŸ¨âŸ©áµ€-use :  PË‚ .!  âˆ—  (PË‚ â†ªâŸ¨ e âŸ©áµ€[ i ] QË‚Ë™)
  -->                âŠ¢[ Î¹ ]âŸ¨ e âŸ©áµ€[ á¹¡ i ] Î» v â†’  QË‚Ë™ v .!

  -- Modify âŸ¨ âŸ© proof

  -->  â†ªâŸ¨âŸ©áµ€-â‰¤ :  i â‰¤ j  â†’   PË‚ â†ªâŸ¨ e âŸ©áµ€[ i ] QË‚Ë™  âŠ¢[ Î¹ ]  PË‚ â†ªâŸ¨ e âŸ©áµ€[ j ] QË‚Ë™

  -->  â†ªâŸ¨âŸ©-eatË¡â»Ë¡áµ˜á´º :  {{Basic R}}  â†’   R  âˆ—  P'Ë‚ .!  âŠ¢[< Î¹ ][ i ]â‡›á´º  PË‚ .!  â†’
  -->                  R  âˆ—  (PË‚ â†ªâŸ¨ e âŸ©[ Îº ] QË‚Ë™)  âŠ¢[ Î¹ ]  P'Ë‚ â†ªâŸ¨ e âŸ©[ Îº ] QË‚Ë™

  â†ªâŸ¨âŸ©-eatË¡â»Ë¡áµ˜ :  {{Basic R}}  â†’   R  âˆ—  P'Ë‚ .!  âŠ¢[< Î¹ ][ i ]â‡›  PË‚ .!  â†’
                 R  âˆ—  (PË‚ â†ªâŸ¨ e âŸ©[ Îº ] QË‚Ë™)  âŠ¢[ Î¹ ]  P'Ë‚ â†ªâŸ¨ e âŸ©[ Îº ] QË‚Ë™
  â†ªâŸ¨âŸ©-eatË¡â»Ë¡áµ˜ =  â†ªâŸ¨âŸ©-eatË¡â»Ë¡áµ˜á´º âˆ˜ (â‡›â‡’â‡›á´º $áµ€Ê°_)

  â†ªâŸ¨âŸ©-eatË¡â»Ë¡ :  {{Basic R}}  â†’
    R  âˆ—  (PË‚ â†ªâŸ¨ e âŸ©[ Îº ] QË‚Ë™)  âŠ¢[ Î¹ ]  Â¡á´¾ (R -âˆ— PË‚ .!) â†ªâŸ¨ e âŸ©[ Îº ] QË‚Ë™
  â†ªâŸ¨âŸ©-eatË¡â»Ë¡ =  â†ªâŸ¨âŸ©-eatË¡â»Ë¡áµ˜ {i = 0} $ â‡’< $ â‡’â‡› $ -âˆ—-elimË¡ âŠ¢-refl

  â†ªâŸ¨âŸ©-monoË¡áµ˜á´º :  P'Ë‚ .!  âŠ¢[< Î¹ ][ i ]â‡›á´º  PË‚ .!  â†’
                 PË‚ â†ªâŸ¨ e âŸ©[ Îº ] QË‚Ë™  âŠ¢[ Î¹ ]  P'Ë‚ â†ªâŸ¨ e âŸ©[ Îº ] QË‚Ë™
  â†ªâŸ¨âŸ©-monoË¡áµ˜á´º P'âŠ¢â‡›P =  âŠ¤âˆ—-intro Â» â†ªâŸ¨âŸ©-eatË¡â»Ë¡áµ˜á´º $ (âˆ—-elimÊ³ Â»áµ˜á´º_) $áµ€Ê° P'âŠ¢â‡›P

  â†ªâŸ¨âŸ©-monoË¡áµ˜ :  P'Ë‚ .!  âŠ¢[< Î¹ ][ i ]â‡›  PË‚ .!  â†’
                PË‚ â†ªâŸ¨ e âŸ©[ Îº ] QË‚Ë™  âŠ¢[ Î¹ ]  P'Ë‚ â†ªâŸ¨ e âŸ©[ Îº ] QË‚Ë™
  â†ªâŸ¨âŸ©-monoË¡áµ˜ =  â†ªâŸ¨âŸ©-monoË¡áµ˜á´º âˆ˜ (â‡›â‡’â‡›á´º $áµ€Ê°_)

  â†ªâŸ¨âŸ©-monoË¡ :  P'Ë‚ .! âŠ¢[< Î¹ ] PË‚ .! â†’
               PË‚ â†ªâŸ¨ e âŸ©[ Îº ] QË‚Ë™  âŠ¢[ Î¹ ]  P'Ë‚ â†ªâŸ¨ e âŸ©[ Îº ] QË‚Ë™
  â†ªâŸ¨âŸ©-monoË¡ =  â†ªâŸ¨âŸ©-monoË¡áµ˜ {i = 0} âˆ˜ (â‡’â‡› $áµ€Ê°_)

  -->  â†ªâŸ¨âŸ©-monoÊ³áµ˜á´º :  (âˆ€ v â†’  QË‚Ë™ v .!  âŠ¢[< Î¹ ][ i ]â‡›á´º  Q'Ë‚Ë™ v .!)  â†’
  -->                 PË‚ â†ªâŸ¨ e âŸ©[ Îº ] QË‚Ë™  âŠ¢[ Î¹ ]  PË‚ â†ªâŸ¨ e âŸ©[ Îº ] Q'Ë‚Ë™

  â†ªâŸ¨âŸ©-monoÊ³áµ˜ :  (âˆ€ v â†’  QË‚Ë™ v .!  âŠ¢[< Î¹ ][ i ]â‡›  Q'Ë‚Ë™ v .!)  â†’
                PË‚ â†ªâŸ¨ e âŸ©[ Îº ] QË‚Ë™  âŠ¢[ Î¹ ]  PË‚ â†ªâŸ¨ e âŸ©[ Îº ] Q'Ë‚Ë™
  â†ªâŸ¨âŸ©-monoÊ³áµ˜ QvâŠ¢â‡›Q'v =  â†ªâŸ¨âŸ©-monoÊ³áµ˜á´º Î» v â†’ â‡›â‡’â‡›á´º $áµ€Ê° QvâŠ¢â‡›Q'v v

  â†ªâŸ¨âŸ©-monoÊ³ :  (âˆ€ v â†’  QË‚Ë™ v .!  âŠ¢[< Î¹ ]  Q'Ë‚Ë™ v .!)  â†’
               PË‚ â†ªâŸ¨ e âŸ©[ Îº ] QË‚Ë™  âŠ¢[ Î¹ ]  PË‚ â†ªâŸ¨ e âŸ©[ Îº ] Q'Ë‚Ë™
  â†ªâŸ¨âŸ©-monoÊ³ QvâŠ¢Q'v =  â†ªâŸ¨âŸ©-monoÊ³áµ˜ {i = 0} Î» v â†’ â‡’â‡› $áµ€Ê° QvâŠ¢Q'v v

  -->  â†ªâŸ¨âŸ©-eatË¡â»Ê³ :  {{Basic R}}  â†’
  -->    R  âˆ—  (PË‚ â†ªâŸ¨ e âŸ©[ Îº ] QË‚Ë™)  âŠ¢[ Î¹ ]
  -->      PË‚ â†ªâŸ¨ e âŸ©[ Îº ] Î» v â†’ Â¡á´¾ (R âˆ— QË‚Ë™ v .!)

  -->  â†ªâŸ¨âŸ©-frameÊ³ :  PË‚ â†ªâŸ¨ e âŸ©[ Îº ] QË‚Ë™  âŠ¢[ Î¹ ]
  -->                  Â¡á´¾ (R âˆ— PË‚ .!) â†ªâŸ¨ e âŸ©[ Îº ] Î» v â†’ Â¡á´¾ (R âˆ— QË‚Ë™ v .!)

  â†ªâŸ¨âŸ©-frameË¡ :  PË‚ â†ªâŸ¨ e âŸ©[ Îº ] QË‚Ë™  âŠ¢[ Î¹ ]
                  Â¡á´¾ (PË‚ .! âˆ— R) â†ªâŸ¨ e âŸ©[ Îº ] Î» v â†’ Â¡á´¾ (QË‚Ë™ v .! âˆ— R)
  â†ªâŸ¨âŸ©-frameË¡ =  â†ªâŸ¨âŸ©-frameÊ³ Â» â†ªâŸ¨âŸ©-monoË¡ (â‡’< âˆ—-comm) Â» â†ªâŸ¨âŸ©-monoÊ³ Î» _ â†’ â‡’< âˆ—-comm

  ------------------------------------------------------------------------------
  -- On â†ªâŸ¨ âŸ©âˆ

  -- Modify âŸ¨ âŸ© proof

  -->  â†ªâŸ¨âŸ©âˆ-â‰¤ :  i â‰¤ j  â†’   PË‚ â†ª[ i ]âŸ¨ e âŸ©âˆ  âŠ¢[ Î¹ ]  PË‚ â†ª[ j ]âŸ¨ e âŸ©âˆ

  -->  â†ªâŸ¨âŸ©âˆ-eatË¡â»áµ˜á´º :  {{Basic R}}  â†’   R  âˆ—  QË‚ .!  âŠ¢[< Î¹ ][ i ]â‡›á´º  PË‚ .!  â†’
  -->                  R  âˆ—  (PË‚ â†ª[ j ]âŸ¨ e âŸ©âˆ)  âŠ¢[ Î¹ ]  QË‚ â†ª[ j ]âŸ¨ e âŸ©âˆ

  â†ªâŸ¨âŸ©âˆ-eatË¡â»áµ˜ :  {{Basic R}}  â†’   R  âˆ—  QË‚ .!  âŠ¢[< Î¹ ][ i ]â‡›  PË‚ .!  â†’
                 R  âˆ—  (PË‚ â†ª[ j ]âŸ¨ e âŸ©âˆ)  âŠ¢[ Î¹ ]  QË‚ â†ª[ j ]âŸ¨ e âŸ©âˆ
  â†ªâŸ¨âŸ©âˆ-eatË¡â»áµ˜ =  â†ªâŸ¨âŸ©âˆ-eatË¡â»áµ˜á´º âˆ˜ (â‡›â‡’â‡›á´º $áµ€Ê°_)

  â†ªâŸ¨âŸ©âˆ-eatË¡ :  {{Basic R}}  â†’
    R  âˆ—  (PË‚ â†ª[ i ]âŸ¨ e âŸ©âˆ)  âŠ¢[ Î¹ ]  Â¡á´¾ (R -âˆ— PË‚ .!) â†ª[ i ]âŸ¨ e âŸ©âˆ
  â†ªâŸ¨âŸ©âˆ-eatË¡ =  â†ªâŸ¨âŸ©âˆ-eatË¡â»áµ˜ {i = 0} $ â‡’< $ â‡’â‡› $ -âˆ—-elimË¡ âŠ¢-refl

  â†ªâŸ¨âŸ©âˆ-monoáµ˜á´º :  QË‚ .!  âŠ¢[< Î¹ ][ i ]â‡›á´º  PË‚ .!  â†’
                 PË‚ â†ª[ j ]âŸ¨ e âŸ©âˆ  âŠ¢[ Î¹ ]  QË‚ â†ª[ j ]âŸ¨ e âŸ©âˆ
  â†ªâŸ¨âŸ©âˆ-monoáµ˜á´º QâŠ¢â‡›P =  âŠ¤âˆ—-intro Â» â†ªâŸ¨âŸ©âˆ-eatË¡â»áµ˜á´º $ (âˆ—-elimÊ³ Â»áµ˜á´º_) $áµ€Ê° QâŠ¢â‡›P

  â†ªâŸ¨âŸ©âˆ-monoáµ˜ :  QË‚ .!  âŠ¢[< Î¹ ][ i ]â‡›  PË‚ .!  â†’
                PË‚ â†ª[ j ]âŸ¨ e âŸ©âˆ  âŠ¢[ Î¹ ]  QË‚ â†ª[ j ]âŸ¨ e âŸ©âˆ
  â†ªâŸ¨âŸ©âˆ-monoáµ˜ =  â†ªâŸ¨âŸ©âˆ-monoáµ˜á´º âˆ˜ (â‡›â‡’â‡›á´º $áµ€Ê°_)

  â†ªâŸ¨âŸ©âˆ-mono :  QË‚ .!  âŠ¢[< Î¹ ]  PË‚ .!  â†’
               PË‚ â†ª[ i ]âŸ¨ e âŸ©âˆ  âŠ¢[ Î¹ ]  QË‚ â†ª[ i ]âŸ¨ e âŸ©âˆ
  â†ªâŸ¨âŸ©âˆ-mono =  â†ªâŸ¨âŸ©âˆ-monoáµ˜ {i = 0} âˆ˜ (â‡’â‡› $áµ€Ê°_)
